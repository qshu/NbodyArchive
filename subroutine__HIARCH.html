<html>
  <link REL="STYLESHEET" HREF="syntax.css" TYPE="text/css">
  <body>
    <table cellpadding="20" border="1">
      <thead>
        <tr>
        <td colspan="2"><center><h1>nbody6</h1></center>
<table width="100%">
  <tbody>
    <tr>
      <td width="30%" align="center"><a href="project__nbody6.html">Home</a></td>
      <td width="40%" align="center"><a href="call_project__nbody6.html">Call tree</a></td>
      <td width="30%" align="center"><a href="tree_project__nbody6.html">Structure tree</a></td>
    </tr>
  </tbody>
</table>

</td>
    </tr>
      </thead>
      <tbody>
        <tr>
          <td width="10%" align="left" valign="top"><ul>
  <li><a href="File__absorb.f.html">absorb.f</a></li>
</ul><ul>
  <li><a href="File__adjust.F.html">adjust.F</a></li>
</ul><ul>
  <li><a href="File__bindat.F.html">bindat.F</a></li>
</ul><ul>
  <li><a href="File__binout.f.html">binout.f</a></li>
</ul><ul>
  <li><a href="File__binpop.F.html">binpop.F</a></li>
</ul><ul>
  <li><a href="File__binpop_old.f.html">binpop_old.f</a></li>
</ul><ul>
  <li><a href="File__binpop_pk.f.html">binpop_pk.f</a></li>
</ul><ul>
  <li><a href="File__block.f.html">block.f</a></li>
</ul><ul>
  <li><a href="File__bodies.f.html">bodies.f</a></li>
</ul><ul>
  <li><a href="File__brake.f.html">brake.f</a></li>
</ul><ul>
  <li><a href="File__cfuncs.f.html">cfuncs.f</a></li>
</ul><ul>
  <li><a href="File__chain.f.html">chain.f</a></li>
</ul><ul>
  <li><a href="File__chdata.f.html">chdata.f</a></li>
</ul><ul>
  <li><a href="File__check.f.html">check.f</a></li>
</ul><ul>
  <li><a href="File__checkl.f.html">checkl.f</a></li>
</ul><ul>
  <li><a href="File__chfind.f.html">chfind.f</a></li>
</ul><ul>
  <li><a href="File__chfirr.f.html">chfirr.f</a></li>
</ul><ul>
  <li><a href="File__chinit.f.html">chinit.f</a></li>
</ul><ul>
  <li><a href="File__chlist.f.html">chlist.f</a></li>
</ul><ul>
  <li><a href="File__chmod.f.html">chmod.f</a></li>
</ul><ul>
  <li><a href="File__chpot.f.html">chpot.f</a></li>
</ul><ul>
  <li><a href="File__chstab.f.html">chstab.f</a></li>
</ul><ul>
  <li><a href="File__chterm.f.html">chterm.f</a></li>
</ul><ul>
  <li><a href="File__clint.f.html">clint.f</a></li>
</ul><ul>
  <li><a href="File__cloud.f.html">cloud.f</a></li>
</ul><ul>
  <li><a href="File__cloud0.F.html">cloud0.F</a></li>
</ul><ul>
  <li><a href="File__cmbody.f.html">cmbody.f</a></li>
</ul><ul>
  <li><a href="File__cmcorr.f.html">cmcorr.f</a></li>
</ul><ul>
  <li><a href="File__cmfirr.f.html">cmfirr.f</a></li>
</ul><ul>
  <li><a href="File__cmfreg.f.html">cmfreg.f</a></li>
</ul><ul>
  <li><a href="File__const.f.html">const.f</a></li>
</ul><ul>
  <li><a href="File__core.f.html">core.f</a></li>
</ul><ul>
  <li><a href="File__cputim.F.html">cputim.F</a></li>
</ul><ul>
  <li><a href="File__cstab2.f.html">cstab2.f</a></li>
</ul><ul>
  <li><a href="File__cstab3.f.html">cstab3.f</a></li>
</ul><ul>
  <li><a href="File__cstab4.f.html">cstab4.f</a></li>
</ul><ul>
  <li><a href="File__cstab5.f.html">cstab5.f</a></li>
</ul><ul>
  <li><a href="File__data.F.html">data.F</a></li>
</ul><ul>
  <li><a href="File__define.f.html">define.f</a></li>
</ul><ul>
  <li><a href="File__delay.f.html">delay.f</a></li>
</ul><ul>
  <li><a href="File__derqp.f.html">derqp.f</a></li>
</ul><ul>
  <li><a href="File__derqp3.f.html">derqp3.f</a></li>
</ul><ul>
  <li><a href="File__derqp4.f.html">derqp4.f</a></li>
</ul><ul>
  <li><a href="File__difsy1.f.html">difsy1.f</a></li>
</ul><ul>
  <li><a href="File__difsy3.f.html">difsy3.f</a></li>
</ul><ul>
  <li><a href="File__difsy4.f.html">difsy4.f</a></li>
</ul><ul>
  <li><a href="File__efac2.f.html">efac2.f</a></li>
</ul><ul>
  <li><a href="File__efac3.f.html">efac3.f</a></li>
</ul><ul>
  <li><a href="File__eigenvalue.f.html">eigenvalue.f</a></li>
</ul><ul>
  <li><a href="File__ellan.f.html">ellan.f</a></li>
</ul><ul>
  <li><a href="File__endreg.f.html">endreg.f</a></li>
</ul><ul>
  <li><a href="File__energy.f.html">energy.f</a></li>
</ul><ul>
  <li><a href="File__energy_mpi.f.html">energy_mpi.f</a></li>
</ul><ul>
  <li><a href="File__erel.f.html">erel.f</a></li>
</ul><ul>
  <li><a href="File__erel3.f.html">erel3.f</a></li>
</ul><ul>
  <li><a href="File__erel4.f.html">erel4.f</a></li>
</ul><ul>
  <li><a href="File__escape.F.html">escape.F</a></li>
</ul><ul>
  <li><a href="File__events.f.html">events.f</a></li>
</ul><ul>
  <li><a href="File__evolve.f.html">evolve.f</a></li>
</ul><ul>
  <li><a href="File__expand.f.html">expand.f</a></li>
</ul><ul>
  <li><a href="File__extend.f.html">extend.f</a></li>
</ul><ul>
  <li><a href="File__fchain.f.html">fchain.f</a></li>
</ul><ul>
  <li><a href="File__fclose.f.html">fclose.f</a></li>
</ul><ul>
  <li><a href="File__fcloud.f.html">fcloud.f</a></li>
</ul><ul>
  <li><a href="File__fcorr.f.html">fcorr.f</a></li>
</ul><ul>
  <li><a href="File__ficorr.f.html">ficorr.f</a></li>
</ul><ul>
  <li><a href="File__file_init.F.html">file_init.F</a></li>
</ul><ul>
  <li><a href="File__findj.f.html">findj.f</a></li>
</ul><ul>
  <li><a href="File__flush.f.html">flush.f</a></li>
</ul><ul>
  <li><a href="File__flush.t3e.f.html">flush.t3e.f</a></li>
</ul><ul>
  <li><a href="File__flyby.f.html">flyby.f</a></li>
</ul><ul>
  <li><a href="File__fpcorr.f.html">fpcorr.f</a></li>
</ul><ul>
  <li><a href="File__fpert.f.html">fpert.f</a></li>
</ul><ul>
  <li><a href="File__fpoly1.f.html">fpoly1.f</a></li>
</ul><ul>
  <li><a href="File__fpoly1_mpi.f.html">fpoly1_mpi.f</a></li>
</ul><ul>
  <li><a href="File__fpoly2.f.html">fpoly2.f</a></li>
</ul><ul>
  <li><a href="File__fpoly2_mpi.f.html">fpoly2_mpi.f</a></li>
</ul><ul>
  <li><a href="File__freeze.f.html">freeze.f</a></li>
</ul><ul>
  <li><a href="File__ghost.f.html">ghost.f</a></li>
</ul><ul>
  <li><a href="File__gntage.f.html">gntage.f</a></li>
</ul><ul>
  <li><a href="File__hcorr.f.html">hcorr.f</a></li>
</ul><ul>
  <li><a href="File__hiarch.f.html">hiarch.f</a></li>
</ul><ul>
  <li><a href="File__hidat.f.html">hidat.f</a></li>
</ul><ul>
  <li><a href="File__himax.f.html">himax.f</a></li>
</ul><ul>
  <li><a href="File__himax2.f.html">himax2.f</a></li>
</ul><ul>
  <li><a href="File__hipop.F.html">hipop.F</a></li>
</ul><ul>
  <li><a href="File__histab.f.html">histab.f</a></li>
</ul><ul>
  <li><a href="File__hivel.f.html">hivel.f</a></li>
</ul><ul>
  <li><a href="File__hmdot.f.html">hmdot.f</a></li>
</ul><ul>
  <li><a href="File__hmdot2.f.html">hmdot2.f</a></li>
</ul><ul>
  <li><a href="File__hotsys.F.html">hotsys.F</a></li>
</ul><ul>
  <li><a href="File__hpsort.f.html">hpsort.f</a></li>
</ul><ul>
  <li><a href="File__hrdiag.f.html">hrdiag.f</a></li>
</ul><ul>
  <li><a href="File__hrplot.f.html">hrplot.f</a></li>
</ul><ul>
  <li><a href="File__iblock.f.html">iblock.f</a></li>
</ul><ul>
  <li><a href="File__ichain.f.html">ichain.f</a></li>
</ul><ul>
  <li><a href="File__imf.f.html">imf.f</a></li>
</ul><ul>
  <li><a href="File__imf2.f.html">imf2.f</a></li>
</ul><ul>
  <li><a href="File__imfbd.f.html">imfbd.f</a></li>
</ul><ul>
  <li><a href="File__impact.f.html">impact.f</a></li>
</ul><ul>
  <li><a href="File__inclin.f.html">inclin.f</a></li>
</ul><ul>
  <li><a href="File__indexx.f.html">indexx.f</a></li>
</ul><ul>
  <li><a href="File__inext.f.html">inext.f</a></li>
</ul><ul>
  <li><a href="File__input.F.html">input.F</a></li>
</ul><ul>
  <li><a href="File__insert.f.html">insert.f</a></li>
</ul><ul>
  <li><a href="File__instar.f.html">instar.f</a></li>
</ul><ul>
  <li><a href="File__intgrt.F.html">intgrt.F</a></li>
</ul><ul>
  <li><a href="File__intide.F.html">intide.F</a></li>
</ul><ul>
  <li><a href="File__invert.f.html">invert.f</a></li>
</ul><ul>
  <li><a href="File__kcpert.f.html">kcpert.f</a></li>
</ul><ul>
  <li><a href="File__kepler.f.html">kepler.f</a></li>
</ul><ul>
  <li><a href="File__kick.f.html">kick.f</a></li>
</ul><ul>
  <li><a href="File__ksapo.f.html">ksapo.f</a></li>
</ul><ul>
  <li><a href="File__kscorr.f.html">kscorr.f</a></li>
</ul><ul>
  <li><a href="File__ksin2.f.html">ksin2.f</a></li>
</ul><ul>
  <li><a href="File__ksinit.f.html">ksinit.f</a></li>
</ul><ul>
  <li><a href="File__ksint.F.html">ksint.F</a></li>
</ul><ul>
  <li><a href="File__kslist.f.html">kslist.f</a></li>
</ul><ul>
  <li><a href="File__ksmod.f.html">ksmod.f</a></li>
</ul><ul>
  <li><a href="File__ksperi.f.html">ksperi.f</a></li>
</ul><ul>
  <li><a href="File__kspert.f.html">kspert.f</a></li>
</ul><ul>
  <li><a href="File__ksphys.f.html">ksphys.f</a></li>
</ul><ul>
  <li><a href="File__kspoly.f.html">kspoly.f</a></li>
</ul><ul>
  <li><a href="File__kspred.f.html">kspred.f</a></li>
</ul><ul>
  <li><a href="File__ksrect.f.html">ksrect.f</a></li>
</ul><ul>
  <li><a href="File__ksreg.f.html">ksreg.f</a></li>
</ul><ul>
  <li><a href="File__ksres.f.html">ksres.f</a></li>
</ul><ul>
  <li><a href="File__ksres2.f.html">ksres2.f</a></li>
</ul><ul>
  <li><a href="File__ksterm.f.html">ksterm.f</a></li>
</ul><ul>
  <li><a href="File__kstide.f.html">kstide.f</a></li>
</ul><ul>
  <li><a href="File__lagr.F.html">lagr.F</a></li>
</ul><ul>
  <li><a href="File__levels.f.html">levels.f</a></li>
</ul><ul>
  <li><a href="File__matrix.f.html">matrix.f</a></li>
</ul><ul>
  <li><a href="File__mdot.f.html">mdot.f</a></li>
</ul><ul>
  <li><a href="File__merge.f.html">merge.f</a></li>
</ul><ul>
  <li><a href="File__merge2.f.html">merge2.f</a></li>
</ul><ul>
  <li><a href="File__mloss.f.html">mloss.f</a></li>
</ul><ul>
  <li><a href="File__mlwind.f.html">mlwind.f</a></li>
</ul><ul>
  <li><a href="File__modify.F.html">modify.F</a></li>
</ul><ul>
  <li><a href="File__mydump.F.html">mydump.F</a></li>
</ul><ul>
  <li><a href="File__nbint.f.html">nbint.f</a></li>
</ul><ul>
  <li><a href="File__nblist.f.html">nblist.f</a></li>
</ul><ul>
  <li><a href="File__nbody6.F.html">nbody6.F</a></li>
</ul><ul>
  <li><a href="File__nbpot.f.html">nbpot.f</a></li>
</ul><ul>
  <li><a href="File__nbrem.f.html">nbrem.f</a></li>
</ul><ul>
  <li><a href="File__nbrest.f.html">nbrest.f</a></li>
</ul><ul>
  <li><a href="File__nbsort.f.html">nbsort.f</a></li>
</ul><ul>
  <li><a href="File__nbtide.f.html">nbtide.f</a></li>
</ul><ul>
  <li><a href="File__newreg.f.html">newreg.f</a></li>
</ul><ul>
  <li><a href="File__newsys.f.html">newsys.f</a></li>
</ul><ul>
  <li><a href="File__nlmod.f.html">nlmod.f</a></li>
</ul><ul>
  <li><a href="File__offset.f.html">offset.f</a></li>
</ul><ul>
  <li><a href="File__orbit.f.html">orbit.f</a></li>
</ul><ul>
  <li><a href="File__output.F.html">output.F</a></li>
</ul><ul>
  <li><a href="File__peri.f.html">peri.f</a></li>
</ul><ul>
  <li><a href="File__permit.f.html">permit.f</a></li>
</ul><ul>
  <li><a href="File__pfac.f.html">pfac.f</a></li>
</ul><ul>
  <li><a href="File__physks.f.html">physks.f</a></li>
</ul><ul>
  <li><a href="File__qforce.f.html">qforce.f</a></li>
</ul><ul>
  <li><a href="File__qpmod.f.html">qpmod.f</a></li>
</ul><ul>
  <li><a href="File__qpmod3.f.html">qpmod3.f</a></li>
</ul><ul>
  <li><a href="File__qpmod4.f.html">qpmod4.f</a></li>
</ul><ul>
  <li><a href="File__quad.f.html">quad.f</a></li>
</ul><ul>
  <li><a href="File__r2sort.f.html">r2sort.f</a></li>
</ul><ul>
  <li><a href="File__ran2.f.html">ran2.f</a></li>
</ul><ul>
  <li><a href="File__rchain.f.html">rchain.f</a></li>
</ul><ul>
  <li><a href="File__recoil.f.html">recoil.f</a></li>
</ul><ul>
  <li><a href="File__redraw.f.html">redraw.f</a></li>
</ul><ul>
  <li><a href="File__reduce.f.html">reduce.f</a></li>
</ul><ul>
  <li><a href="File__reflct.f.html">reflct.f</a></li>
</ul><ul>
  <li><a href="File__regint.f.html">regint.f</a></li>
</ul><ul>
  <li><a href="File__reinit.f.html">reinit.f</a></li>
</ul><ul>
  <li><a href="File__remove.f.html">remove.f</a></li>
</ul><ul>
  <li><a href="File__rename.f.html">rename.f</a></li>
</ul><ul>
  <li><a href="File__renew.f.html">renew.f</a></li>
</ul><ul>
  <li><a href="File__reset.f.html">reset.f</a></li>
</ul><ul>
  <li><a href="File__reset2.f.html">reset2.f</a></li>
</ul><ul>
  <li><a href="File__resolv.f.html">resolv.f</a></li>
</ul><ul>
  <li><a href="File__resort.f.html">resort.f</a></li>
</ul><ul>
  <li><a href="File__rsort.f.html">rsort.f</a></li>
</ul><ul>
  <li><a href="File__rssort.f.html">rssort.f</a></li>
</ul><ul>
  <li><a href="File__scale.F.html">scale.F</a></li>
</ul><ul>
  <li><a href="File__search.f.html">search.f</a></li>
</ul><ul>
  <li><a href="File__select.f.html">select.f</a></li>
</ul><ul>
  <li><a href="File__setsys.f.html">setsys.f</a></li>
</ul><ul>
  <li><a href="File__setup.f.html">setup.f</a></li>
</ul><ul>
  <li><a href="File__short.f.html">short.f</a></li>
</ul><ul>
  <li><a href="File__shrink.f.html">shrink.f</a></li>
</ul><ul>
  <li><a href="File__slow.f.html">slow.f</a></li>
</ul><ul>
  <li><a href="File__sort1.f.html">sort1.f</a></li>
</ul><ul>
  <li><a href="File__sort3.f.html">sort3.f</a></li>
</ul><ul>
  <li><a href="File__stabl3.f.html">stabl3.f</a></li>
</ul><ul>
  <li><a href="File__stabl4.f.html">stabl4.f</a></li>
</ul><ul>
  <li><a href="File__stablc.f.html">stablc.f</a></li>
</ul><ul>
  <li><a href="File__stablz.f.html">stablz.f</a></li>
</ul><ul>
  <li><a href="File__star.f.html">star.f</a></li>
</ul><ul>
  <li><a href="File__start.F.html">start.F</a></li>
</ul><ul>
  <li><a href="File__start3.f.html">start3.f</a></li>
</ul><ul>
  <li><a href="File__start4.f.html">start4.f</a></li>
</ul><ul>
  <li><a href="File__status.f.html">status.f</a></li>
</ul><ul>
  <li><a href="File__stepi.f.html">stepi.f</a></li>
</ul><ul>
  <li><a href="File__stepk.f.html">stepk.f</a></li>
</ul><ul>
  <li><a href="File__steps.f.html">steps.f</a></li>
</ul><ul>
  <li><a href="File__stumpf.f.html">stumpf.f</a></li>
</ul><ul>
  <li><a href="File__subint.f.html">subint.f</a></li>
</ul><ul>
  <li><a href="File__subsys.f.html">subsys.f</a></li>
</ul><ul>
  <li><a href="File__swcond.f.html">swcond.f</a></li>
</ul><ul>
  <li><a href="File__switch.f.html">switch.f</a></li>
</ul><ul>
  <li><a href="File__tchain.f.html">tchain.f</a></li>
</ul><ul>
  <li><a href="File__tcirc.f.html">tcirc.f</a></li>
</ul><ul>
  <li><a href="File__tides.f.html">tides.f</a></li>
</ul><ul>
  <li><a href="File__tperi.f.html">tperi.f</a></li>
</ul><ul>
  <li><a href="File__tpert.f.html">tpert.f</a></li>
</ul><ul>
  <li><a href="File__trans3.f.html">trans3.f</a></li>
</ul><ul>
  <li><a href="File__trans4.f.html">trans4.f</a></li>
</ul><ul>
  <li><a href="File__transk.f.html">transk.f</a></li>
</ul><ul>
  <li><a href="File__transq.f.html">transq.f</a></li>
</ul><ul>
  <li><a href="File__transx.f.html">transx.f</a></li>
</ul><ul>
  <li><a href="File__triple.f.html">triple.f</a></li>
</ul><ul>
  <li><a href="File__tstep.f.html">tstep.f</a></li>
</ul><ul>
  <li><a href="File__units.f.html">units.f</a></li>
</ul><ul>
  <li><a href="File__unpert.f.html">unpert.f</a></li>
</ul><ul>
  <li><a href="File__update.f.html">update.f</a></li>
</ul><ul>
  <li><a href="File__vector.f.html">vector.f</a></li>
</ul><ul>
  <li><a href="File__verify.f.html">verify.f</a></li>
</ul><ul>
  <li><a href="File__xcpred.f.html">xcpred.f</a></li>
</ul><ul>
  <li><a href="File__xtf.f.html">xtf.f</a></li>
</ul><ul>
  <li><a href="File__xtpert.f.html">xtpert.f</a></li>
</ul><ul>
  <li><a href="File__xtrnl0.f.html">xtrnl0.f</a></li>
</ul><ul>
  <li><a href="File__xtrnld.f.html">xtrnld.f</a></li>
</ul><ul>
  <li><a href="File__xtrnlf.f.html">xtrnlf.f</a></li>
</ul><ul>
  <li><a href="File__xtrnlp.f.html">xtrnlp.f</a></li>
</ul><ul>
  <li><a href="File__xtrnlu.f.html">xtrnlu.f</a></li>
</ul><ul>
  <li><a href="File__xtrnlv.f.html">xtrnlv.f</a></li>
</ul><ul>
  <li><a href="File__xvpred.f.html">xvpred.f</a></li>
</ul><ul>
  <li><a href="File__ycopy.f.html">ycopy.f</a></li>
</ul><ul>
  <li><a href="File__ysave.f.html">ysave.f</a></li>
</ul><ul>
  <li><a href="File__zare.f.html">zare.f</a></li>
</ul><ul>
  <li><a href="File__zcnsts.f.html">zcnsts.f</a></li>
</ul><ul>
  <li><a href="File__zdata.f.html">zdata.f</a></li>
</ul><ul>
  <li><a href="File__zero.f.html">zero.f</a></li>
</ul><ul>
  <li><a href="File__zfuncs.f.html">zfuncs.f</a></li>
</ul>
</td>
          <td width="90%" valign="top">
            <h2><b>subroutine</b>:<i>HIARCH</i></h2><br>
            <h3>      SUBROUTINE HIARCH(IPAIR)
</h3>
            Author:<i></i><br>
            Version:<i></i><br>
            <p>Belongs to: <a href="File__hiarch.f.html">hiarch.f</a></p>
            <p>Located at: <a href="File__hiarch.f.html">hiarch.f</a></p>
            <div>Uses:
              <ul>
                <li><a href="subroutine__DATA.html">DATA</a> at <a href="File__data.F.html">data.F</a></li>
              </ul><ul>
                <li><a href="subroutine__FLUSH.html">FLUSH</a> at <a href="File__flush.f.html">flush.f</a></li>
              </ul><ul>
                <li><a href="subroutine__RESOLV.html">RESOLV</a> at <a href="File__resolv.f.html">resolv.f</a></li>
              </ul>
            </div>
            <div>Used by:
              <ul>
                <li><a href="subroutine__CHSTAB.html">CHSTAB</a> at <a href="File__chstab.f.html">chstab.f</a></li>
              </ul><ul>
                <li><a href="subroutine__ESCAPE.html">ESCAPE</a> at <a href="File__escape.F.html">escape.F</a></li>
              </ul><ul>
                <li><a href="subroutine__MERGE.html">MERGE</a> at <a href="File__merge.f.html">merge.f</a></li>
              </ul><ul>
                <li><a href="subroutine__MERGE2.html">MERGE2</a> at <a href="File__merge2.f.html">merge2.f</a></li>
              </ul><ul>
                <li><a href="subroutine__RESET.html">RESET</a> at <a href="File__reset.f.html">reset.f</a></li>
              </ul><ul>
                <li><a href="subroutine__RESET2.html">RESET2</a> at <a href="File__reset2.f.html">reset2.f</a></li>
              </ul>
            </div>
            <tt>
<br>
<br>       Hierarchical system diagnostics.
<br>       --------------------------------
<br>
</tt>
            
            <h3>Variables</h3>
            <table border="1">
              <tr><td> A1(3)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> A2(3)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> XREL(3)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> VREL(3)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> EI(3)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> HI(3)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> HO(3)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> TK0(100)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> TLAST(100)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> TTERM(100)</td><td>REAL*8</td><td></td><td></td></tr><tr><td> LAST(100)</td><td>INTEGER</td><td></td><td></td></tr><tr><td> IPRINT(100)</td><td>INTEGER</td><td></td><td></td></tr><tr><td>FIRST</td><td>LOGICAL</td><td></td><td></td></tr>
            </table>
            <pre class="source">      <span class="kw">SUBROUTINE</span> <a href="subroutine__HIARCH.html">HIARCH</a>(IPAIR)
<span class="comm">*
</span><span class="comm">*
</span><span class="comm">*       Hierarchical system diagnostics.
</span><span class="comm">*       --------------------------------
</span><span class="comm">*
</span>      <span class="kw">INCLUDE</span> <span class="str">'common6.h'</span>
      <span class="dtype">REAL</span>*8  A1(3),A2(3),XREL(3),VREL(3),EI(3),HI(3),HO(3),
        TK0(100),TLAST(100),TTERM(100)
      <span class="dtype">INTEGER</span>  LAST(100),IPRINT(100)
      <span class="dtype">LOGICAL</span>  FIRST
      SAVE  FIRST,TLAST,TTERM,RAP,TK0,LAST,IPRINT,NL
      <a href="subroutine__DATA.html">DATA</a>  FIRST /.TRUE./
      <a href="subroutine__DATA.html">DATA</a>  LAST,IPRINT  /200*0/
<span class="comm">*
</span><span class="comm">*
</span><span class="comm">*       Print cluster scaling parameters at start of the run.
</span>      <span class="kw">IF</span> (FIRST) <span class="kw">THEN</span>
          <span class="kw">IF</span> (NMERG.EQ.0) <span class="kw">THEN</span>
              WRITE (12,1)  RBAR, BODYM*ZMBAR, BODY1*ZMBAR, TSCALE,
                      NBIN0, NZERO
    1         <span class="kw">FORMAT</span> (/,6X,<span class="str">'MODEL:    RBAR ='</span>,F5.1,<span class="str">'  <M> ='</span>,F6.2,
                     <span class="str">'  M1 ='</span>,F6.1,<span class="str">'  TSCALE ='</span>,F6.2,
                     <span class="str">'  NB ='</span>,I4,<span class="str">'  N0 ='</span>,I6,//)
          <span class="kw">END</span> <span class="kw">IF</span>
<span class="comm">*
</span><span class="comm">*       Define the saved variables in case of COMMON dump during merger.
</span>          TK0(1) = 1.0
          RAP = 1.0
          NL = 0
          TLAST(1) = 0.0
          TTERM(1) = 0.0
          WRITE (12,2)
    2     <span class="kw">FORMAT</span> (<span class="str">'      TIME   A         A1        E1    PMIN'</span>,
            <span class="str">'    P1/P0  Q     PCR   MB    Q1     I      NAME'</span>,
            <span class="str">'        KC'</span>,/)
          WRITE (12,3)
    3     <span class="kw">FORMAT</span> (<span class="str">'             r/Rc                           '</span>,
           <span class="str">'           Rc   GAM   IT        N0   N1   KS  NAME'</span>,/)
      <span class="kw">END</span> <span class="kw">IF</span>
<span class="comm">*
</span><span class="comm">*       Set c.m. and component indices.
</span>      I = N + IPAIR
      I1 = 2*IPAIR - 1
      I2 = I1 + 1
      TTOT = TIME + TOFF
<span class="comm">*
</span><span class="comm">*       Skip printing termination at line #2 until after first new merger.
</span>      <span class="kw">IF</span> (IPHASE.EQ.7.AND.NL.EQ.0) <span class="kw">THEN</span>
          GO TO 30
      <span class="kw">END</span> <span class="kw">IF</span>
<span class="comm">*
</span><span class="comm">*       Determine index of current merger (may have been set previously).
</span>      IL = 0
      <span class="kw">DO</span> 4 L = 1,NL
          <span class="kw">IF</span> (NAME(I1).EQ.LAST(L)) <span class="kw">THEN</span>
              IL = L
          <span class="kw">END</span> <span class="kw">IF</span>
    4 <span class="kw">CONTINUE</span>
<span class="comm">*
</span><span class="comm">*       Increase membership and set identifier = 0 temporarily for new case.
</span>      <span class="kw">IF</span> (IL.EQ.0) <span class="kw">THEN</span>
          NL = NL + 1
          IL = NL
          LAST(IL) = 0
      <span class="kw">END</span> <span class="kw">IF</span>
<span class="comm">*
</span><span class="comm">*       Decide whether new merger or termination should be printed.
</span>      <span class="kw">IF</span> (IPHASE.EQ.6) <span class="kw">THEN</span>
          <span class="kw">IF</span> (NAME(I1).EQ.LAST(IL)) <span class="kw">THEN</span>
              TLAST(IL) = TTOT
<span class="comm">*       Avoid repeated output of same system if terminated recently (< TCR).
</span>              <span class="kw">IF</span> (TTOT - TTERM(IL).LT.TCR) <span class="kw">THEN</span>
                  IPRINT(IL) = 0
                  GO TO 30
              <span class="kw">ELSE</span>
                  IPRINT(IL) = 1
              <span class="kw">END</span> <span class="kw">IF</span>
          <span class="kw">ELSE</span>
<span class="comm">*       Save identity and merge time and set print indicator for line #2.
</span>              LAST(IL) = NAME(I1)
              TLAST(IL) = TTOT
              TTERM(IL) = 0.0D0
              IPRINT(IL) = 1
          <span class="kw">END</span> <span class="kw">IF</span>
      <span class="kw">ELSE</span>
          TTERM(IL) = TTOT
<span class="comm">*       Skip output of line #2 if line #1 was not printed.
</span>          <span class="kw">IF</span> (IPRINT(IL).EQ.0) <span class="kw">THEN</span>
              GO TO 30
          <span class="kw">END</span> <span class="kw">IF</span>
          IPRINT(IL) = 0
      <span class="kw">END</span> <span class="kw">IF</span>
<span class="comm">*
</span><span class="comm">*       Form semi-major axis and eccentricity (skip hyperbolic orbits).
</span>      SEMI = -0.5*BODY(I)/H(IPAIR)
      <span class="kw">IF</span> (SEMI.LT.0.0) GO TO 30
      ECC2 = (1.0D0 - R(IPAIR)/SEMI)**2 + TDOT2(IPAIR)**2/(BODY(I)*SEMI)
      ECC = SQRT(ECC2)
<span class="comm">*       Skip highly eccentric fly-by's which are not formally stable.
</span>      <span class="kw">IF</span> (ECC.GT.0.99) GO TO 30
      TK = TWOPI*SEMI*SQRT(SEMI/BODY(I))
<span class="comm">*
</span><span class="comm">*       Decide between new and terminated merger.
</span>      <span class="kw">IF</span> (IPHASE.EQ.6) <span class="kw">THEN</span>
<span class="comm">*       Ensure that unperturbed binary is resolved.
</span>          <span class="kw">IF</span> (LIST(1,I1).EQ.0.OR.X(1,I1).EQ.X(1,I2)) <span class="kw">THEN</span>
              <span class="kw">CALL</span> <a href="subroutine__RESOLV.html">RESOLV</a>(IPAIR,1)
          <span class="kw">END</span> <span class="kw">IF</span>
          Q = BODY(I)/BODY(JCOMP)
          Q1 = MAX(BODY(I2)/BODY(I1),BODY(I1)/BODY(I2))
          RAP = SEMI*(1.0D0 + ECC)
          RIJ2 = 0.0
          VIJ2 = 0.0
          RDOT = 0.0
          A12 = 0.0
          A22 = 0.0
          A1A2 = 0.0
          RI2 = 0.0
          VI2 = 0.0
          RVI = 0.0
          <span class="kw">DO</span> 5 K = 1,3
              RIJ2 = RIJ2 + (X(K,I) - X(K,JCOMP))**2
              VIJ2 = VIJ2 + (XDOT(K,I) - XDOT(K,JCOMP))**2
              RDOT = RDOT + (X(K,I) - X(K,JCOMP))*
                                       (XDOT(K,I) - XDOT(K,JCOMP))
              K1 = K + 1
              <span class="kw">IF</span> (K1.GT.3) K1 = 1
              K2 = K1 + 1
              <span class="kw">IF</span> (K2.GT.3) K2 = 1
              A1(K) = (X(K1,I1) - X(K1,I2))*(XDOT(K2,I1) - XDOT(K2,I2))
              - (X(K2,I1) - X(K2,I2))*(XDOT(K1,I1) - XDOT(K1,I2))
              A2(K) = (X(K1,JCOMP) - X(K1,I))*
                                     (XDOT(K2,JCOMP) - XDOT(K2,I))
              - (X(K2,JCOMP) - X(K2,I))*
                                     (XDOT(K1,JCOMP) - XDOT(K1,I))
              A12 = A12 + A1(K)**2
              A22 = A22 + A2(K)**2
              A1A2 = A1A2 + A1(K)*A2(K)
<span class="comm">*       Form relative vectors and scalars for inner binary.
</span>              XREL(K) = X(K,I1) - X(K,I2)
              VREL(K) = XDOT(K,I1) - XDOT(K,I2)
              RI2 = RI2 + XREL(K)**2
              VI2 = VI2 + VREL(K)**2
              RVI = RVI + XREL(K)*VREL(K)
    5     <span class="kw">CONTINUE</span>
<span class="comm">*
</span><span class="comm">*      Evaluate orbital parameters for outer orbit (skip hyperbolic case).
</span>          RIJ = SQRT(RIJ2)
          ZMB = BODY(I) + BODY(JCOMP)
          SEMI1 = 2.0/RIJ - VIJ2/ZMB
          SEMI1 = 1.0/SEMI1
          <span class="kw">IF</span> (SEMI1.LT.0.0) GO TO 30
          ECC1 = SQRT((1.0 - RIJ/SEMI1)**2 + RDOT**2/(SEMI1*ZMB))
          PMIN = SEMI1*(1.0D0 - ECC1)
          TK1 = TWOPI*SEMI1*SQRT(SEMI1/ZMB)
          PMIN = MIN(PMIN/RAP,999.0D0)
          TK1 = MIN(TK1/TK,99999.0D0)
<span class="comm">*       Determine inclination (8 bins of 22.5 degrees).
</span>          FAC = A1A2/SQRT(A12*A22)
          FAC = ACOS(FAC)
<span class="comm">*         II = 1 + FAC*360.0/(TWOPI*22.5)
</span>          IDEG = 360.0*FAC/TWOPI
<span class="comm">*
</span><span class="comm">*       Construct Runge-Lenz vector (Heggie & Rasio, 1995, IAU174, Eq.(5)).
</span>          EI2 = 0.0
          <span class="kw">DO</span> 6 K = 1,3
              EI(K) = (VI2*XREL(K) - RVI*VREL(K))/BODY(I) -
                                                 XREL(K)/SQRT(RI2)
              EI2 = EI2 + EI(K)**2
    6     <span class="kw">CONTINUE</span>
<span class="comm">*
</span><span class="comm">*       Define unit vectors for inner eccentricity and angular momenta.
</span>          COSJ = 0.0
          SJSG = 0.0
          <span class="kw">DO</span> 8 K = 1,3
              EI(K) = EI(K)/SQRT(EI2)
              HI(K) = A1(K)/SQRT(A12)
              HO(K) = A2(K)/SQRT(A22)
              COSJ = COSJ + HI(K)*HO(K)
              SJSG = SJSG + EI(K)*HO(K)
    8     <span class="kw">CONTINUE</span>
<span class="comm">*
</span><span class="comm">*       Form the expressions A & Z.
</span>          A = COSJ*SQRT(1.0 - EI2)
          Z = (1.0 - EI2)*(2.0 - COSJ**2) + 5.0*EI2*SJSG**2
<span class="comm">*
</span><span class="comm">*       Obtain maximum inner eccentricity (Douglas Heggie, Sept. 1995).
</span>          Z2 = Z**2 + 25.0 + 16.0*A**4 - 10.0*Z - 20.0*A**2 - 8.0*A**2*Z
          EMAX = ONE6*(Z + 1.0 - 4.0*A**2 + SQRT(Z2))
          EMAX = SQRT(EMAX)
          KCM = KSTAR(I)
          <span class="kw">IF</span> (NAME(I).LT.0) KCM = -10
          NEWHI = NEWHI + 1
<span class="comm">*
</span>          WRITE (12,10)  TTOT, SEMI, SEMI1, ECC1, PMIN, TK1, Q,
                   PCRIT/SEMI, BODY(I)/BODYM, Q1, IDEG,
                   NAME(I1), NAME(I2), NAME(JCOMP), KCM
   10     <span class="kw">FORMAT</span> (/,<span class="str">' #1'</span>,F8.1,1P,2E10.2,0P,F6.2,F7.2,F8.1,3F6.2,F5.1,
                    I5,2I5,I6,I4)
<span class="comm">*
</span>          WRITE (30,10)  TTOT, SEMI, SEMI1, ECC1, PMIN, TK1, Q,
                   PCRIT/SEMI, BODY(I)/BODYM, Q1, IDEG,
                   NAME(I1), NAME(I2), NAME(JCOMP), KCM
<span class="comm">*
</span>          RBIG = MAX(RADIUS(I1),RADIUS(I2))
          PMIN = SEMI*(1.0 - ECC)
          PMIN2 = SEMI*(1.0 - EMAX)
          <span class="kw">IF</span> (KZ(19).EQ.3) <span class="kw">THEN</span>
              R1 = PMIN/RBIG
              R2 = PMIN2/RBIG
          <span class="kw">ELSE</span>
              R1 = 0.0
              R2 = 0.0
          <span class="kw">END</span> <span class="kw">IF</span>
          ZI = FAC
          EM = SQRT(SIN(ZI)**2 + EI2*COS(ZI)**2)
          WRITE (30,11)  SQRT(EI2), EMAX, KSTAR(I1), KSTAR(I2),KSTAR(I),
                   SEMI, A, Z, PMIN2, R1, R2, EM
   11     <span class="kw">FORMAT</span> (<span class="str">' INNER:    E EMAX K* SEMI A Z PM2 R1 R2 EM '</span>,
                        2F8.4,3I3,1P,4E10.2,0P,2F7.1,F7.3)
          <span class="kw">CALL</span> <a href="subroutine__FLUSH.html">FLUSH</a>(30)
<span class="comm">*       Save parameters for termination diagnostics.
</span>          TK0(IL) = TK
<span class="comm">*
</span>      <span class="kw">ELSE</span> <span class="kw">IF</span> (IPHASE.EQ.7) <span class="kw">THEN</span>
          PMIN = SEMI*(1.0D0 - ECC)
          PMIN = MIN(PMIN/RAP,999.0D0)
          <span class="kw">IF</span> (TK0(IL).LE.0.0D0) TK0(IL) = TK
          TK1 = MIN(TK/TK0(IL),99999.0D0)
          NK = (TTOT - TLAST(IL))/TK0(IL)
          NK1 = (TTOT - TLAST(IL))/TK
          NK = MIN(NK,99999999)
          NK1 = MIN(NK1,9999)
          NK = MAX(NK,0)
          RI = 0.0
          <span class="kw">DO</span> 15 K = 1,3
              RI = RI + (X(K,I) - RDENS(K))**2
   15     <span class="kw">CONTINUE</span>
          RR = RC/RSCALE
<span class="comm">*
</span><span class="comm">*       Define type index (0, 1 or KSTAR; note: #I1 is inner c.m.).
</span>          IT = 0
          <span class="kw">IF</span> (TIME.GT.MIN(TEV(I1),TEV(I2),TEV(I))) IT = 1
          <span class="kw">IF</span> (KSTAR(I1).NE.0.AND.IT.EQ.0) IT = KSTAR(I1)
<span class="comm">*
</span>          WRITE (12,20)  TTOT, SQRT(RI)/RC, SEMI, ECC, PMIN, TK1,
                   RR, GAMMA(IPAIR), IT, NK, NK1, NPAIRS, NAME(I2)
   20     <span class="kw">FORMAT</span> (<span class="str">' #2'</span>,F8.1,1P,2E10.2,0P,F6.2,F7.2,F8.1,2F6.2,I4,I10,
                  3I6)
          <span class="kw">CALL</span> <a href="subroutine__FLUSH.html">FLUSH</a>(12)
          WRITE (30,20)  TTOT, SQRT(RI)/RC, SEMI, ECC, PMIN, TK1,
                   RR, GAMMA(IPAIR), IT, NK, NK1, NPAIRS, NAME(I2)
      <span class="kw">END</span> <span class="kw">IF</span>
<span class="comm">*
</span><span class="comm">*       Restrict memory of previous cases by removing the oldest one.
</span>   30 <span class="kw">IF</span> (NL.GE.100) <span class="kw">THEN</span>
          LT = 1
<span class="comm">*       Skip any current mergers (defined by TTERM = 0.0).
</span>   32     <span class="kw">IF</span> (TTERM(LT).LE.0.0D0) <span class="kw">THEN</span>
              LT = LT + 1
              GO TO 32
          <span class="kw">END</span> <span class="kw">IF</span>
          <span class="kw">DO</span> 35 L = LT,NL-1
              TLAST(L) = TLAST(L+1)
              TTERM(L) = TTERM(L+1)
              TK0(L) = TK0(L+1)
              LAST(L) = LAST(L+1)
              IPRINT(L) = IPRINT(L+1)
   35     <span class="kw">CONTINUE</span>
          NL = NL - 1
      <span class="kw">END</span> <span class="kw">IF</span>
<span class="comm">*
</span>      <span class="kw">RETURN</span>
<span class="comm">*
</span>      <span class="kw">END</span>
</pre>
            
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

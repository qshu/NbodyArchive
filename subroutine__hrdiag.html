<html>
  <link REL="STYLESHEET" HREF="syntax.css" TYPE="text/css">
  <body>
    <table cellpadding="20" border="1">
      <thead>
        <tr>
        <td colspan="2"><center><h1>nbody6</h1></center>
<table width="100%">
  <tbody>
    <tr>
      <td width="30%" align="center"><a href="project__nbody6.html">Home</a></td>
      <td width="40%" align="center"><a href="call_project__nbody6.html">Call tree</a></td>
      <td width="30%" align="center"><a href="tree_project__nbody6.html">Structure tree</a></td>
    </tr>
  </tbody>
</table>

</td>
    </tr>
      </thead>
      <tbody>
        <tr>
          <td width="10%" align="left" valign="top"><ul>
  <li><a href="File__absorb.f.html">absorb.f</a></li>
</ul><ul>
  <li><a href="File__adjust.F.html">adjust.F</a></li>
</ul><ul>
  <li><a href="File__bindat.F.html">bindat.F</a></li>
</ul><ul>
  <li><a href="File__binout.f.html">binout.f</a></li>
</ul><ul>
  <li><a href="File__binpop.F.html">binpop.F</a></li>
</ul><ul>
  <li><a href="File__binpop_old.f.html">binpop_old.f</a></li>
</ul><ul>
  <li><a href="File__binpop_pk.f.html">binpop_pk.f</a></li>
</ul><ul>
  <li><a href="File__block.f.html">block.f</a></li>
</ul><ul>
  <li><a href="File__bodies.f.html">bodies.f</a></li>
</ul><ul>
  <li><a href="File__brake.f.html">brake.f</a></li>
</ul><ul>
  <li><a href="File__cfuncs.f.html">cfuncs.f</a></li>
</ul><ul>
  <li><a href="File__chain.f.html">chain.f</a></li>
</ul><ul>
  <li><a href="File__chdata.f.html">chdata.f</a></li>
</ul><ul>
  <li><a href="File__check.f.html">check.f</a></li>
</ul><ul>
  <li><a href="File__checkl.f.html">checkl.f</a></li>
</ul><ul>
  <li><a href="File__chfind.f.html">chfind.f</a></li>
</ul><ul>
  <li><a href="File__chfirr.f.html">chfirr.f</a></li>
</ul><ul>
  <li><a href="File__chinit.f.html">chinit.f</a></li>
</ul><ul>
  <li><a href="File__chlist.f.html">chlist.f</a></li>
</ul><ul>
  <li><a href="File__chmod.f.html">chmod.f</a></li>
</ul><ul>
  <li><a href="File__chpot.f.html">chpot.f</a></li>
</ul><ul>
  <li><a href="File__chstab.f.html">chstab.f</a></li>
</ul><ul>
  <li><a href="File__chterm.f.html">chterm.f</a></li>
</ul><ul>
  <li><a href="File__clint.f.html">clint.f</a></li>
</ul><ul>
  <li><a href="File__cloud.f.html">cloud.f</a></li>
</ul><ul>
  <li><a href="File__cloud0.F.html">cloud0.F</a></li>
</ul><ul>
  <li><a href="File__cmbody.f.html">cmbody.f</a></li>
</ul><ul>
  <li><a href="File__cmcorr.f.html">cmcorr.f</a></li>
</ul><ul>
  <li><a href="File__cmfirr.f.html">cmfirr.f</a></li>
</ul><ul>
  <li><a href="File__cmfreg.f.html">cmfreg.f</a></li>
</ul><ul>
  <li><a href="File__const.f.html">const.f</a></li>
</ul><ul>
  <li><a href="File__core.f.html">core.f</a></li>
</ul><ul>
  <li><a href="File__cputim.F.html">cputim.F</a></li>
</ul><ul>
  <li><a href="File__cstab2.f.html">cstab2.f</a></li>
</ul><ul>
  <li><a href="File__cstab3.f.html">cstab3.f</a></li>
</ul><ul>
  <li><a href="File__cstab4.f.html">cstab4.f</a></li>
</ul><ul>
  <li><a href="File__cstab5.f.html">cstab5.f</a></li>
</ul><ul>
  <li><a href="File__data.F.html">data.F</a></li>
</ul><ul>
  <li><a href="File__define.f.html">define.f</a></li>
</ul><ul>
  <li><a href="File__delay.f.html">delay.f</a></li>
</ul><ul>
  <li><a href="File__derqp.f.html">derqp.f</a></li>
</ul><ul>
  <li><a href="File__derqp3.f.html">derqp3.f</a></li>
</ul><ul>
  <li><a href="File__derqp4.f.html">derqp4.f</a></li>
</ul><ul>
  <li><a href="File__difsy1.f.html">difsy1.f</a></li>
</ul><ul>
  <li><a href="File__difsy3.f.html">difsy3.f</a></li>
</ul><ul>
  <li><a href="File__difsy4.f.html">difsy4.f</a></li>
</ul><ul>
  <li><a href="File__efac2.f.html">efac2.f</a></li>
</ul><ul>
  <li><a href="File__efac3.f.html">efac3.f</a></li>
</ul><ul>
  <li><a href="File__eigenvalue.f.html">eigenvalue.f</a></li>
</ul><ul>
  <li><a href="File__ellan.f.html">ellan.f</a></li>
</ul><ul>
  <li><a href="File__endreg.f.html">endreg.f</a></li>
</ul><ul>
  <li><a href="File__energy.f.html">energy.f</a></li>
</ul><ul>
  <li><a href="File__energy_mpi.f.html">energy_mpi.f</a></li>
</ul><ul>
  <li><a href="File__erel.f.html">erel.f</a></li>
</ul><ul>
  <li><a href="File__erel3.f.html">erel3.f</a></li>
</ul><ul>
  <li><a href="File__erel4.f.html">erel4.f</a></li>
</ul><ul>
  <li><a href="File__escape.F.html">escape.F</a></li>
</ul><ul>
  <li><a href="File__events.f.html">events.f</a></li>
</ul><ul>
  <li><a href="File__evolve.f.html">evolve.f</a></li>
</ul><ul>
  <li><a href="File__expand.f.html">expand.f</a></li>
</ul><ul>
  <li><a href="File__extend.f.html">extend.f</a></li>
</ul><ul>
  <li><a href="File__fchain.f.html">fchain.f</a></li>
</ul><ul>
  <li><a href="File__fclose.f.html">fclose.f</a></li>
</ul><ul>
  <li><a href="File__fcloud.f.html">fcloud.f</a></li>
</ul><ul>
  <li><a href="File__fcorr.f.html">fcorr.f</a></li>
</ul><ul>
  <li><a href="File__ficorr.f.html">ficorr.f</a></li>
</ul><ul>
  <li><a href="File__file_init.F.html">file_init.F</a></li>
</ul><ul>
  <li><a href="File__findj.f.html">findj.f</a></li>
</ul><ul>
  <li><a href="File__flush.f.html">flush.f</a></li>
</ul><ul>
  <li><a href="File__flush.t3e.f.html">flush.t3e.f</a></li>
</ul><ul>
  <li><a href="File__flyby.f.html">flyby.f</a></li>
</ul><ul>
  <li><a href="File__fpcorr.f.html">fpcorr.f</a></li>
</ul><ul>
  <li><a href="File__fpert.f.html">fpert.f</a></li>
</ul><ul>
  <li><a href="File__fpoly1.f.html">fpoly1.f</a></li>
</ul><ul>
  <li><a href="File__fpoly1_mpi.f.html">fpoly1_mpi.f</a></li>
</ul><ul>
  <li><a href="File__fpoly2.f.html">fpoly2.f</a></li>
</ul><ul>
  <li><a href="File__fpoly2_mpi.f.html">fpoly2_mpi.f</a></li>
</ul><ul>
  <li><a href="File__freeze.f.html">freeze.f</a></li>
</ul><ul>
  <li><a href="File__ghost.f.html">ghost.f</a></li>
</ul><ul>
  <li><a href="File__gntage.f.html">gntage.f</a></li>
</ul><ul>
  <li><a href="File__hcorr.f.html">hcorr.f</a></li>
</ul><ul>
  <li><a href="File__hiarch.f.html">hiarch.f</a></li>
</ul><ul>
  <li><a href="File__hidat.f.html">hidat.f</a></li>
</ul><ul>
  <li><a href="File__himax.f.html">himax.f</a></li>
</ul><ul>
  <li><a href="File__himax2.f.html">himax2.f</a></li>
</ul><ul>
  <li><a href="File__hipop.F.html">hipop.F</a></li>
</ul><ul>
  <li><a href="File__histab.f.html">histab.f</a></li>
</ul><ul>
  <li><a href="File__hivel.f.html">hivel.f</a></li>
</ul><ul>
  <li><a href="File__hmdot.f.html">hmdot.f</a></li>
</ul><ul>
  <li><a href="File__hmdot2.f.html">hmdot2.f</a></li>
</ul><ul>
  <li><a href="File__hotsys.F.html">hotsys.F</a></li>
</ul><ul>
  <li><a href="File__hpsort.f.html">hpsort.f</a></li>
</ul><ul>
  <li><a href="File__hrdiag.f.html">hrdiag.f</a></li>
</ul><ul>
  <li><a href="File__hrplot.f.html">hrplot.f</a></li>
</ul><ul>
  <li><a href="File__iblock.f.html">iblock.f</a></li>
</ul><ul>
  <li><a href="File__ichain.f.html">ichain.f</a></li>
</ul><ul>
  <li><a href="File__imf.f.html">imf.f</a></li>
</ul><ul>
  <li><a href="File__imf2.f.html">imf2.f</a></li>
</ul><ul>
  <li><a href="File__imfbd.f.html">imfbd.f</a></li>
</ul><ul>
  <li><a href="File__impact.f.html">impact.f</a></li>
</ul><ul>
  <li><a href="File__inclin.f.html">inclin.f</a></li>
</ul><ul>
  <li><a href="File__indexx.f.html">indexx.f</a></li>
</ul><ul>
  <li><a href="File__inext.f.html">inext.f</a></li>
</ul><ul>
  <li><a href="File__input.F.html">input.F</a></li>
</ul><ul>
  <li><a href="File__insert.f.html">insert.f</a></li>
</ul><ul>
  <li><a href="File__instar.f.html">instar.f</a></li>
</ul><ul>
  <li><a href="File__intgrt.F.html">intgrt.F</a></li>
</ul><ul>
  <li><a href="File__intide.F.html">intide.F</a></li>
</ul><ul>
  <li><a href="File__invert.f.html">invert.f</a></li>
</ul><ul>
  <li><a href="File__kcpert.f.html">kcpert.f</a></li>
</ul><ul>
  <li><a href="File__kepler.f.html">kepler.f</a></li>
</ul><ul>
  <li><a href="File__kick.f.html">kick.f</a></li>
</ul><ul>
  <li><a href="File__ksapo.f.html">ksapo.f</a></li>
</ul><ul>
  <li><a href="File__kscorr.f.html">kscorr.f</a></li>
</ul><ul>
  <li><a href="File__ksin2.f.html">ksin2.f</a></li>
</ul><ul>
  <li><a href="File__ksinit.f.html">ksinit.f</a></li>
</ul><ul>
  <li><a href="File__ksint.F.html">ksint.F</a></li>
</ul><ul>
  <li><a href="File__kslist.f.html">kslist.f</a></li>
</ul><ul>
  <li><a href="File__ksmod.f.html">ksmod.f</a></li>
</ul><ul>
  <li><a href="File__ksperi.f.html">ksperi.f</a></li>
</ul><ul>
  <li><a href="File__kspert.f.html">kspert.f</a></li>
</ul><ul>
  <li><a href="File__ksphys.f.html">ksphys.f</a></li>
</ul><ul>
  <li><a href="File__kspoly.f.html">kspoly.f</a></li>
</ul><ul>
  <li><a href="File__kspred.f.html">kspred.f</a></li>
</ul><ul>
  <li><a href="File__ksrect.f.html">ksrect.f</a></li>
</ul><ul>
  <li><a href="File__ksreg.f.html">ksreg.f</a></li>
</ul><ul>
  <li><a href="File__ksres.f.html">ksres.f</a></li>
</ul><ul>
  <li><a href="File__ksres2.f.html">ksres2.f</a></li>
</ul><ul>
  <li><a href="File__ksterm.f.html">ksterm.f</a></li>
</ul><ul>
  <li><a href="File__kstide.f.html">kstide.f</a></li>
</ul><ul>
  <li><a href="File__lagr.F.html">lagr.F</a></li>
</ul><ul>
  <li><a href="File__levels.f.html">levels.f</a></li>
</ul><ul>
  <li><a href="File__matrix.f.html">matrix.f</a></li>
</ul><ul>
  <li><a href="File__mdot.f.html">mdot.f</a></li>
</ul><ul>
  <li><a href="File__merge.f.html">merge.f</a></li>
</ul><ul>
  <li><a href="File__merge2.f.html">merge2.f</a></li>
</ul><ul>
  <li><a href="File__mloss.f.html">mloss.f</a></li>
</ul><ul>
  <li><a href="File__mlwind.f.html">mlwind.f</a></li>
</ul><ul>
  <li><a href="File__modify.F.html">modify.F</a></li>
</ul><ul>
  <li><a href="File__mydump.F.html">mydump.F</a></li>
</ul><ul>
  <li><a href="File__nbint.f.html">nbint.f</a></li>
</ul><ul>
  <li><a href="File__nblist.f.html">nblist.f</a></li>
</ul><ul>
  <li><a href="File__nbody6.F.html">nbody6.F</a></li>
</ul><ul>
  <li><a href="File__nbpot.f.html">nbpot.f</a></li>
</ul><ul>
  <li><a href="File__nbrem.f.html">nbrem.f</a></li>
</ul><ul>
  <li><a href="File__nbrest.f.html">nbrest.f</a></li>
</ul><ul>
  <li><a href="File__nbsort.f.html">nbsort.f</a></li>
</ul><ul>
  <li><a href="File__nbtide.f.html">nbtide.f</a></li>
</ul><ul>
  <li><a href="File__newreg.f.html">newreg.f</a></li>
</ul><ul>
  <li><a href="File__newsys.f.html">newsys.f</a></li>
</ul><ul>
  <li><a href="File__nlmod.f.html">nlmod.f</a></li>
</ul><ul>
  <li><a href="File__offset.f.html">offset.f</a></li>
</ul><ul>
  <li><a href="File__orbit.f.html">orbit.f</a></li>
</ul><ul>
  <li><a href="File__output.F.html">output.F</a></li>
</ul><ul>
  <li><a href="File__peri.f.html">peri.f</a></li>
</ul><ul>
  <li><a href="File__permit.f.html">permit.f</a></li>
</ul><ul>
  <li><a href="File__pfac.f.html">pfac.f</a></li>
</ul><ul>
  <li><a href="File__physks.f.html">physks.f</a></li>
</ul><ul>
  <li><a href="File__qforce.f.html">qforce.f</a></li>
</ul><ul>
  <li><a href="File__qpmod.f.html">qpmod.f</a></li>
</ul><ul>
  <li><a href="File__qpmod3.f.html">qpmod3.f</a></li>
</ul><ul>
  <li><a href="File__qpmod4.f.html">qpmod4.f</a></li>
</ul><ul>
  <li><a href="File__quad.f.html">quad.f</a></li>
</ul><ul>
  <li><a href="File__r2sort.f.html">r2sort.f</a></li>
</ul><ul>
  <li><a href="File__ran2.f.html">ran2.f</a></li>
</ul><ul>
  <li><a href="File__rchain.f.html">rchain.f</a></li>
</ul><ul>
  <li><a href="File__recoil.f.html">recoil.f</a></li>
</ul><ul>
  <li><a href="File__redraw.f.html">redraw.f</a></li>
</ul><ul>
  <li><a href="File__reduce.f.html">reduce.f</a></li>
</ul><ul>
  <li><a href="File__reflct.f.html">reflct.f</a></li>
</ul><ul>
  <li><a href="File__regint.f.html">regint.f</a></li>
</ul><ul>
  <li><a href="File__reinit.f.html">reinit.f</a></li>
</ul><ul>
  <li><a href="File__remove.f.html">remove.f</a></li>
</ul><ul>
  <li><a href="File__rename.f.html">rename.f</a></li>
</ul><ul>
  <li><a href="File__renew.f.html">renew.f</a></li>
</ul><ul>
  <li><a href="File__reset.f.html">reset.f</a></li>
</ul><ul>
  <li><a href="File__reset2.f.html">reset2.f</a></li>
</ul><ul>
  <li><a href="File__resolv.f.html">resolv.f</a></li>
</ul><ul>
  <li><a href="File__resort.f.html">resort.f</a></li>
</ul><ul>
  <li><a href="File__rsort.f.html">rsort.f</a></li>
</ul><ul>
  <li><a href="File__rssort.f.html">rssort.f</a></li>
</ul><ul>
  <li><a href="File__scale.F.html">scale.F</a></li>
</ul><ul>
  <li><a href="File__search.f.html">search.f</a></li>
</ul><ul>
  <li><a href="File__select.f.html">select.f</a></li>
</ul><ul>
  <li><a href="File__setsys.f.html">setsys.f</a></li>
</ul><ul>
  <li><a href="File__setup.f.html">setup.f</a></li>
</ul><ul>
  <li><a href="File__short.f.html">short.f</a></li>
</ul><ul>
  <li><a href="File__shrink.f.html">shrink.f</a></li>
</ul><ul>
  <li><a href="File__slow.f.html">slow.f</a></li>
</ul><ul>
  <li><a href="File__sort1.f.html">sort1.f</a></li>
</ul><ul>
  <li><a href="File__sort3.f.html">sort3.f</a></li>
</ul><ul>
  <li><a href="File__stabl3.f.html">stabl3.f</a></li>
</ul><ul>
  <li><a href="File__stabl4.f.html">stabl4.f</a></li>
</ul><ul>
  <li><a href="File__stablc.f.html">stablc.f</a></li>
</ul><ul>
  <li><a href="File__stablz.f.html">stablz.f</a></li>
</ul><ul>
  <li><a href="File__star.f.html">star.f</a></li>
</ul><ul>
  <li><a href="File__start.F.html">start.F</a></li>
</ul><ul>
  <li><a href="File__start3.f.html">start3.f</a></li>
</ul><ul>
  <li><a href="File__start4.f.html">start4.f</a></li>
</ul><ul>
  <li><a href="File__status.f.html">status.f</a></li>
</ul><ul>
  <li><a href="File__stepi.f.html">stepi.f</a></li>
</ul><ul>
  <li><a href="File__stepk.f.html">stepk.f</a></li>
</ul><ul>
  <li><a href="File__steps.f.html">steps.f</a></li>
</ul><ul>
  <li><a href="File__stumpf.f.html">stumpf.f</a></li>
</ul><ul>
  <li><a href="File__subint.f.html">subint.f</a></li>
</ul><ul>
  <li><a href="File__subsys.f.html">subsys.f</a></li>
</ul><ul>
  <li><a href="File__swcond.f.html">swcond.f</a></li>
</ul><ul>
  <li><a href="File__switch.f.html">switch.f</a></li>
</ul><ul>
  <li><a href="File__tchain.f.html">tchain.f</a></li>
</ul><ul>
  <li><a href="File__tcirc.f.html">tcirc.f</a></li>
</ul><ul>
  <li><a href="File__tides.f.html">tides.f</a></li>
</ul><ul>
  <li><a href="File__tperi.f.html">tperi.f</a></li>
</ul><ul>
  <li><a href="File__tpert.f.html">tpert.f</a></li>
</ul><ul>
  <li><a href="File__trans3.f.html">trans3.f</a></li>
</ul><ul>
  <li><a href="File__trans4.f.html">trans4.f</a></li>
</ul><ul>
  <li><a href="File__transk.f.html">transk.f</a></li>
</ul><ul>
  <li><a href="File__transq.f.html">transq.f</a></li>
</ul><ul>
  <li><a href="File__transx.f.html">transx.f</a></li>
</ul><ul>
  <li><a href="File__triple.f.html">triple.f</a></li>
</ul><ul>
  <li><a href="File__tstep.f.html">tstep.f</a></li>
</ul><ul>
  <li><a href="File__units.f.html">units.f</a></li>
</ul><ul>
  <li><a href="File__unpert.f.html">unpert.f</a></li>
</ul><ul>
  <li><a href="File__update.f.html">update.f</a></li>
</ul><ul>
  <li><a href="File__vector.f.html">vector.f</a></li>
</ul><ul>
  <li><a href="File__verify.f.html">verify.f</a></li>
</ul><ul>
  <li><a href="File__xcpred.f.html">xcpred.f</a></li>
</ul><ul>
  <li><a href="File__xtf.f.html">xtf.f</a></li>
</ul><ul>
  <li><a href="File__xtpert.f.html">xtpert.f</a></li>
</ul><ul>
  <li><a href="File__xtrnl0.f.html">xtrnl0.f</a></li>
</ul><ul>
  <li><a href="File__xtrnld.f.html">xtrnld.f</a></li>
</ul><ul>
  <li><a href="File__xtrnlf.f.html">xtrnlf.f</a></li>
</ul><ul>
  <li><a href="File__xtrnlp.f.html">xtrnlp.f</a></li>
</ul><ul>
  <li><a href="File__xtrnlu.f.html">xtrnlu.f</a></li>
</ul><ul>
  <li><a href="File__xtrnlv.f.html">xtrnlv.f</a></li>
</ul><ul>
  <li><a href="File__xvpred.f.html">xvpred.f</a></li>
</ul><ul>
  <li><a href="File__ycopy.f.html">ycopy.f</a></li>
</ul><ul>
  <li><a href="File__ysave.f.html">ysave.f</a></li>
</ul><ul>
  <li><a href="File__zare.f.html">zare.f</a></li>
</ul><ul>
  <li><a href="File__zcnsts.f.html">zcnsts.f</a></li>
</ul><ul>
  <li><a href="File__zdata.f.html">zdata.f</a></li>
</ul><ul>
  <li><a href="File__zero.f.html">zero.f</a></li>
</ul><ul>
  <li><a href="File__zfuncs.f.html">zfuncs.f</a></li>
</ul>
</td>
          <td width="90%" valign="top">
            <h2><b>subroutine</b>:<i>hrdiag</i></h2><br>
            <h3>      SUBROUTINE hrdiag(mass,aj,mt,tm,tn,tscls,lums,GB,zpars,
                  r,lum,kw,mc,rc)
</h3>
            Author:<i></i><br>
            Version:<i></i><br>
            <p>Belongs to: <a href="File__hrdiag.f.html">hrdiag.f</a></p>
            <p>Located at: <a href="File__hrdiag.f.html">hrdiag.f</a></p>
            <div>Uses:
              <ul>
                <li><a href="function__lalphf.html">lalphf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__lbetaf.html">lbetaf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__lgbtf.html">lgbtf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__lhookf.html">lhookf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__lmcgbf.html">lmcgbf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__lnetaf.html">lnetaf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__lpertf.html">lpertf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__lzhef.html">lzhef</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__mcagbf.html">mcagbf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__mcgbf.html">mcgbf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__mcgbtf.html">mcgbtf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__mcheif.html">mcheif</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__ragbf.html">ragbf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__ralphf.html">ralphf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rbetaf.html">rbetaf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rgammf.html">rgammf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rgbf.html">rgbf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rhelmf.html">rhelmf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rhookf.html">rhookf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rminf.html">rminf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rpertf.html">rpertf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rtmsf.html">rtmsf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rzahbf.html">rzahbf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rzamsf.html">rzamsf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__rzhef.html">rzhef</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="subroutine__star.html">star</a> at <a href="File__star.f.html">star.f</a></li>
              </ul><ul>
                <li><a href="function__tblf.html">tblf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul><ul>
                <li><a href="function__thookf.html">thookf</a> at <a href="File__zfuncs.f.html">zfuncs.f</a></li>
              </ul>
            </div>
            <div>Used by:
              <ul>
                <li><a href="subroutine__CMBODY.html">CMBODY</a> at <a href="File__cmbody.f.html">cmbody.f</a></li>
              </ul><ul>
                <li><a href="subroutine__HRPLOT.html">HRPLOT</a> at <a href="File__hrplot.f.html">hrplot.f</a></li>
              </ul><ul>
                <li><a href="subroutine__INSTAR.html">INSTAR</a> at <a href="File__instar.f.html">instar.f</a></li>
              </ul><ul>
                <li><a href="subroutine__MDOT.html">MDOT</a> at <a href="File__mdot.f.html">mdot.f</a></li>
              </ul>
            </div>
            <tt>**
<br>
<br>
<br>       H-R diagram for stars of different metallicity.
<br>       -----------------------------------------------
<br>
<br>       Computes the new mass, luminosity, radius & stellar type.
<br>       Input (MASS, AJ, TM, TN, LUMS & TSCLS) supplied by routine STAR.
<br>       Ref: P.P. Eggleton, M.J. Fitchett & C.A. Tout (1989) Ap.J. 347, 998.
<br>
<br>       Revised 27th March 1995 by C. A. Tout;
<br>       24th October 1995 to include metallicity;
<br>       14th November 1996 to include naked helium stars;
<br>       28th February 1997 to allow accretion induced supernovae.
<br>
<br>       Revised 5th April 1997 by J. R. Hurley
<br>       to include Z=0.001 as well as Z=0.02, convective overshooting,
<br>       MS hook and more elaborate CHeB.
<br>       Final version by JRH 8/98 for Z in range [0.0001,0.03].
<br>
</tt>
            
            <h3>Variables</h3>
            <table border="1">
              <tr><td>kw</td><td>integer</td><td></td><td></td></tr><tr><td>kwp</td><td>integer</td><td></td><td></td></tr><tr><td>mass</td><td>real*8</td><td></td><td></td></tr><tr><td>aj</td><td>real*8</td><td></td><td></td></tr><tr><td>mt</td><td>real*8</td><td></td><td></td></tr><tr><td>tm</td><td>real*8</td><td></td><td></td></tr><tr><td>tn</td><td>real*8</td><td></td><td></td></tr><tr><td> tscls(20)</td><td>real*8</td><td></td><td></td></tr><tr><td> lums(10)</td><td>real*8</td><td></td><td></td></tr><tr><td> GB(10)</td><td>real*8</td><td></td><td></td></tr><tr><td> zpars(20)</td><td>real*8</td><td></td><td></td></tr><tr><td>r</td><td>real*8</td><td></td><td></td></tr><tr><td>lum</td><td>real*8</td><td></td><td></td></tr><tr><td>mc</td><td>real*8</td><td></td><td></td></tr><tr><td>rc</td><td>real*8</td><td></td><td></td></tr><tr><td>mch</td><td>real*8</td><td></td><td></td></tr><tr><td>mxns</td><td>real*8</td><td></td><td></td></tr><tr><td>mlp</td><td>real*8</td><td></td><td></td></tr><tr><td>mtc</td><td>real*8</td><td></td><td></td></tr><tr><td>thook</td><td>real*8</td><td></td><td></td></tr><tr><td>thg</td><td>real*8</td><td></td><td></td></tr><tr><td>tbagb</td><td>real*8</td><td></td><td></td></tr><tr><td>tau</td><td>real*8</td><td></td><td></td></tr><tr><td>tloop</td><td>real*8</td><td></td><td></td></tr><tr><td>taul</td><td>real*8</td><td></td><td></td></tr><tr><td>tauh</td><td>real*8</td><td></td><td></td></tr><tr><td>tau1</td><td>real*8</td><td></td><td></td></tr><tr><td>tau2</td><td>real*8</td><td></td><td></td></tr><tr><td>dtau</td><td>real*8</td><td></td><td></td></tr><tr><td>texp</td><td>real*8</td><td></td><td></td></tr><tr><td>lx</td><td>real*8</td><td></td><td></td></tr><tr><td>ly</td><td>real*8</td><td></td><td></td></tr><tr><td>dell</td><td>real*8</td><td></td><td></td></tr><tr><td>alpha</td><td>real*8</td><td></td><td></td></tr><tr><td>beta</td><td>real*8</td><td></td><td></td></tr><tr><td>neta</td><td>real*8</td><td></td><td></td></tr><tr><td>rx</td><td>real*8</td><td></td><td></td></tr><tr><td>ry</td><td>real*8</td><td></td><td></td></tr><tr><td>delr</td><td>real*8</td><td></td><td></td></tr><tr><td>rzams</td><td>real*8</td><td></td><td></td></tr><tr><td>rtms</td><td>real*8</td><td></td><td></td></tr><tr><td>gamma</td><td>real*8</td><td></td><td></td></tr><tr><td>rmin</td><td>real*8</td><td></td><td></td></tr><tr><td>taumin</td><td>real*8</td><td></td><td></td></tr><tr><td>mcmax</td><td>real*8</td><td></td><td></td></tr><tr><td>mcx</td><td>real*8</td><td></td><td></td></tr><tr><td>mcy</td><td>real*8</td><td></td><td></td></tr><tr><td>mcbagb</td><td>real*8</td><td></td><td></td></tr><tr><td>lambda</td><td>real*8</td><td></td><td></td></tr><tr><td>am</td><td>real*8</td><td></td><td></td></tr><tr><td>xx</td><td>real*8</td><td></td><td></td></tr><tr><td>rdgen</td><td>real*8</td><td></td><td></td></tr><tr><td>mew</td><td>real*8</td><td></td><td></td></tr><tr><td>lum0</td><td>real*8</td><td></td><td></td></tr><tr><td>kap</td><td>real*8</td><td></td><td></td></tr><tr><td>zeta</td><td>real*8</td><td></td><td></td></tr><tr><td>ahe</td><td>real*8</td><td></td><td></td></tr><tr><td>aco</td><td>real*8</td><td></td><td></td></tr><tr><td>thookf</td><td>real*8</td><td></td><td></td></tr><tr><td>tblf</td><td>real*8</td><td></td><td></td></tr><tr><td>lalphf</td><td>real*8</td><td></td><td></td></tr><tr><td>lbetaf</td><td>real*8</td><td></td><td></td></tr><tr><td>lnetaf</td><td>real*8</td><td></td><td></td></tr><tr><td>lhookf</td><td>real*8</td><td></td><td></td></tr><tr><td>lgbtf</td><td>real*8</td><td></td><td></td></tr><tr><td>lmcgbf</td><td>real*8</td><td></td><td></td></tr><tr><td>lzhef</td><td>real*8</td><td></td><td></td></tr><tr><td>lpertf</td><td>real*8</td><td></td><td></td></tr><tr><td>rzamsf</td><td>real*8</td><td></td><td></td></tr><tr><td>rtmsf</td><td>real*8</td><td></td><td></td></tr><tr><td>ralphf</td><td>real*8</td><td></td><td></td></tr><tr><td>rbetaf</td><td>real*8</td><td></td><td></td></tr><tr><td>rgammf</td><td>real*8</td><td></td><td></td></tr><tr><td>rhookf</td><td>real*8</td><td></td><td></td></tr><tr><td>rgbf</td><td>real*8</td><td></td><td></td></tr><tr><td>rminf</td><td>real*8</td><td></td><td></td></tr><tr><td>ragbf</td><td>real*8</td><td></td><td></td></tr><tr><td>rzahbf</td><td>real*8</td><td></td><td></td></tr><tr><td>rzhef</td><td>real*8</td><td></td><td></td></tr><tr><td>rhelmf</td><td>real*8</td><td></td><td></td></tr><tr><td>rpertf</td><td>real*8</td><td></td><td></td></tr><tr><td>mcgbtf</td><td>real*8</td><td></td><td></td></tr><tr><td>mcgbf</td><td>real*8</td><td></td><td></td></tr><tr><td>mcheif</td><td>real*8</td><td></td><td></td></tr><tr><td>mcagbf</td><td>real*8</td><td></td><td></td></tr>
            </table>
            <pre class="source"><span class="comm">***
</span>      <span class="kw">SUBROUTINE</span> <a href="subroutine__hrdiag.html">hrdiag</a>(mass,aj,mt,tm,tn,tscls,lums,GB,zpars,
                  r,lum,kw,mc,rc)
<span class="comm">*
</span><span class="comm">*
</span><span class="comm">*       H-R diagram for stars of different metallicity.
</span><span class="comm">*       -----------------------------------------------
</span><span class="comm">*
</span><span class="comm">*       Computes the new mass, luminosity, radius & stellar type.
</span><span class="comm">*       Input (MASS, AJ, TM, TN, LUMS & TSCLS) supplied by routine STAR.
</span><span class="comm">*       Ref: P.P. Eggleton, M.J. Fitchett & C.A. Tout (1989) Ap.J. 347, 998.
</span><span class="comm">*
</span><span class="comm">*       Revised 27th March 1995 by C. A. Tout;
</span><span class="comm">*       24th October 1995 to include metallicity;
</span><span class="comm">*       14th November 1996 to include naked helium stars;
</span><span class="comm">*       28th February 1997 to allow accretion induced supernovae.
</span><span class="comm">*
</span><span class="comm">*       Revised 5th April 1997 by J. R. Hurley
</span><span class="comm">*       to include Z=0.001 as well as Z=0.02, convective overshooting,
</span><span class="comm">*       MS hook and more elaborate CHeB.
</span><span class="comm">*       Final version by JRH 8/98 for Z in range [0.0001,0.03].
</span><span class="comm">*
</span>      <span class="dtype">implicit</span> none
<span class="comm">*
</span>      <span class="dtype">integer</span> kw,kwp
<span class="comm">*
</span>      <span class="dtype">real</span>*8 mass,aj,mt,tm,tn,tscls(20),lums(10),GB(10),zpars(20)
      <span class="dtype">real</span>*8 r,lum,mc,rc
      <span class="dtype">real</span>*8 mch,mxns,mlp
      parameter(mch=1.44d0,mxns=1.8d0,mlp=12.d0)
      <span class="dtype">real</span>*8 mtc
<span class="comm">* 
</span>      <span class="dtype">real</span>*8 thook,thg,tbagb,tau,tloop,taul,tauh,tau1,tau2,dtau,texp
      <span class="dtype">real</span>*8 lx,ly,dell,alpha,beta,neta
      <span class="dtype">real</span>*8 rx,ry,delr,rzams,rtms,gamma,rmin,taumin
      parameter(taumin=5.0d-08)
      <span class="dtype">real</span>*8 mcmax,mcx,mcy,mcbagb,lambda
      <span class="dtype">real</span>*8 am,xx,rdgen,mew,lum0,kap,zeta,ahe,aco
      parameter(lum0=7.0d+04,kap=-0.5d0,ahe=6.964d0,aco=44.313d0)
<span class="comm">*
</span>      <span class="dtype">real</span>*8 <a href="function__thookf.html">thookf</a>,<a href="function__tblf.html">tblf</a>
      <span class="dtype">real</span>*8 <a href="function__lalphf.html">lalphf</a>,<a href="function__lbetaf.html">lbetaf</a>,<a href="function__lnetaf.html">lnetaf</a>,<a href="function__lhookf.html">lhookf</a>,<a href="function__lgbtf.html">lgbtf</a>,<a href="function__lmcgbf.html">lmcgbf</a>,<a href="function__lzhef.html">lzhef</a>,<a href="function__lpertf.html">lpertf</a>
      <span class="dtype">real</span>*8 <a href="function__rzamsf.html">rzamsf</a>,<a href="function__rtmsf.html">rtmsf</a>,<a href="function__ralphf.html">ralphf</a>,<a href="function__rbetaf.html">rbetaf</a>,<a href="function__rgammf.html">rgammf</a>,<a href="function__rhookf.html">rhookf</a>
      <span class="dtype">real</span>*8 <a href="function__rgbf.html">rgbf</a>,<a href="function__rminf.html">rminf</a>,<a href="function__ragbf.html">ragbf</a>,<a href="function__rzahbf.html">rzahbf</a>,<a href="function__rzhef.html">rzhef</a>,<a href="function__rhelmf.html">rhelmf</a>,<a href="function__rpertf.html">rpertf</a>
      <span class="dtype">real</span>*8 <a href="function__mcgbtf.html">mcgbtf</a>,<a href="function__mcgbf.html">mcgbf</a>,<a href="function__mcheif.html">mcheif</a>,<a href="function__mcagbf.html">mcagbf</a>
      external <a href="function__thookf.html">thookf</a>,<a href="function__tblf.html">tblf</a>
      external <a href="function__lalphf.html">lalphf</a>,<a href="function__lbetaf.html">lbetaf</a>,<a href="function__lnetaf.html">lnetaf</a>,<a href="function__lhookf.html">lhookf</a>,<a href="function__lgbtf.html">lgbtf</a>,<a href="function__lmcgbf.html">lmcgbf</a>,<a href="function__lzhef.html">lzhef</a>,<a href="function__lpertf.html">lpertf</a>
      external <a href="function__rzamsf.html">rzamsf</a>,<a href="function__rtmsf.html">rtmsf</a>,<a href="function__ralphf.html">ralphf</a>,<a href="function__rbetaf.html">rbetaf</a>,<a href="function__rgammf.html">rgammf</a>,<a href="function__rhookf.html">rhookf</a>
      external <a href="function__rgbf.html">rgbf</a>,<a href="function__rminf.html">rminf</a>,<a href="function__ragbf.html">ragbf</a>,<a href="function__rzahbf.html">rzahbf</a>,<a href="function__rzhef.html">rzhef</a>,<a href="function__rhelmf.html">rhelmf</a>,<a href="function__rpertf.html">rpertf</a>
      external <a href="function__mcgbtf.html">mcgbtf</a>,<a href="function__mcgbf.html">mcgbf</a>,<a href="function__mcheif.html">mcheif</a>,<a href="function__mcagbf.html">mcagbf</a>
<span class="comm">*
</span><span class="comm">*
</span><span class="comm">*       ---------------------------------------------------------------------
</span><span class="comm">*       MASS    Stellar mass in solar units (input: old; output: new value).
</span><span class="comm">*       AJ      Current age in Myr.
</span><span class="comm">*       MT      Current mass in solar units (used for R).
</span><span class="comm">*       TM      Main sequence time.
</span><span class="comm">*       TN      Nuclear burning time.
</span><span class="comm">*       TSCLS   Time scale for different stages.
</span><span class="comm">*       LUMS    Characteristic luminosity.
</span><span class="comm">*       GB      Giant Branch parameters
</span><span class="comm">*       ZPARS   Parameters for distinguishing various mass intervals.
</span><span class="comm">*       R       Stellar radius in solar units.
</span><span class="comm">*       TE      Effective temperature (suppressed).
</span><span class="comm">*       KW      Classification type (1 - 15).
</span><span class="comm">*       MC      Core mass.
</span><span class="comm">*       ---------------------------------------------------------------------
</span><span class="comm">*
</span><span class="comm">*
</span>      mc = 0.d0
      tbagb = tscls(2) + tscls(3)
      thg = tscls(1) - tm
<span class="comm">*
</span><span class="comm">* Make evolutionary changes to stars that have not reached KW > 5.
</span><span class="comm">*
</span>      <span class="kw">if</span>(kw.gt.6) <span class="kw">goto</span> 90
<span class="comm">*
</span>      <span class="kw">if</span>(aj.lt.tscls(1))<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">*        Either on MS or HG
</span><span class="comm">*
</span>         rzams = <a href="function__rzamsf.html">rzamsf</a>(mass)
         rtms = <a href="function__rtmsf.html">rtmsf</a>(mass)
<span class="comm">*
</span>         <span class="kw">if</span>(aj.lt.tm)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">*           Main sequence star.
</span><span class="comm">*
</span>            tau = aj/tm
            thook = <a href="function__thookf.html">thookf</a>(mass)*tscls(1)
            zeta = 0.01d0
            tau1 = MIN(1.d0,aj/thook)
            tau2 = MAX(0.d0,
             MIN(1.d0,(aj-(1.d0-zeta)*thook)/(zeta*thook)))
<span class="comm">*
</span>            dell = <a href="function__lhookf.html">lhookf</a>(mass,zpars(1))
            dtau = tau1**2 - tau2**2
            alpha = <a href="function__lalphf.html">lalphf</a>(mass)
            beta = <a href="function__lbetaf.html">lbetaf</a>(mass)
            neta = <a href="function__lnetaf.html">lnetaf</a>(mass)
            lx = LOG10(lums(2)/lums(1))
            <span class="kw">if</span>(tau.gt.taumin)<span class="kw">then</span>
               xx = alpha*tau + beta*tau**neta +
              (lx - alpha - beta)*tau**2 - dell*dtau
            <span class="kw">else</span>
               xx = alpha*tau + (lx - alpha)*tau**2 - dell*dtau
            <span class="kw">endif</span>
            lum = lums(1)*10.d0**xx
<span class="comm">*
</span>            delr = <a href="function__rhookf.html">rhookf</a>(mass,zpars(1))
            dtau = tau1**3 - tau2**3
            alpha = <a href="function__ralphf.html">ralphf</a>(mass)
            beta = <a href="function__rbetaf.html">rbetaf</a>(mass)
            gamma = <a href="function__rgammf.html">rgammf</a>(mass)
            rx = LOG10(rtms/rzams)
<span class="comm">* Note that the use of taumin is a slightly pedantic attempt to
</span><span class="comm">* avoid floating point underflow. It IS overkill!
</span>            <span class="kw">if</span>(tau.gt.taumin)<span class="kw">then</span>
               xx = alpha*tau + beta*tau**10 + gamma*tau**40 +
              (rx - alpha - beta - gamma)*tau**3 - delr*dtau
            <span class="kw">else</span>
               xx = alpha*tau + (rx - alpha)*tau**3 - delr*dtau
            <span class="kw">endif</span>
            r = rzams*10.d0**xx
<span class="comm">*
</span>            <span class="kw">if</span>(mass.lt.(zpars(1)-0.3))<span class="kw">then</span>
               kw = 0
<span class="comm">* This following is given by Chris for low mass MS stars which will be 
</span><span class="comm">* substantially degenerate. We need the Hydrogen abundance, X, which we 
</span><span class="comm">* calculate from Z assuming that the helium abundance, Y, is calculated
</span><span class="comm">* according to Y = 0.24 + 2*Z
</span>               rdgen = 0.0258d0*((1.d0+zpars(11))**(5.d0/3.d0))*
                          (mass**(-1.d0/3.d0))
               r = MAX(rdgen,r)
            <span class="kw">else</span>
               kw = 1
            <span class="kw">endif</span>
<span class="comm">*
</span>         <span class="kw">else</span> 
<span class="comm">*
</span><span class="comm">*           Star is on the HG
</span><span class="comm">*
</span>            <span class="kw">if</span>(mass.le.zpars(2))<span class="kw">then</span>
               mc = <a href="function__mcgbf.html">mcgbf</a>(lums(3),GB,lums(6))
            elseif(mass.le.zpars(3))<span class="kw">then</span>
               mc = <a href="function__mcheif.html">mcheif</a>(mass,zpars(2),zpars(9))
            <span class="kw">else</span>
               mc = <a href="function__mcheif.html">mcheif</a>(mass,zpars(2),zpars(10))
            <span class="kw">endif</span>
<span class="comm">*
</span><span class="comm">* Test whether core mass has reached total mass.
</span><span class="comm">*
</span>            <span class="kw">if</span>(mc.ge.mt)<span class="kw">then</span>
               aj = 0.d0
               <span class="kw">if</span>(mass.gt.zpars(2))<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Zero-age helium star
</span><span class="comm">*
</span>                  mc = mt
                  mass = mt
                  kw = 7
                  <span class="kw">CALL</span> <a href="subroutine__star.html">star</a>(kw,mass,mt,tm,tn,tscls,lums,GB,zpars)
               <span class="kw">else</span>
<span class="comm">*
</span><span class="comm">* Zero-age helium white dwarf.
</span><span class="comm">*
</span>                  mc = mt
                  kw = 10
               <span class="kw">endif</span>
            <span class="kw">else</span>
               tau = (aj - tm)/thg
               lum = lums(2)*(lums(3)/lums(2))**tau
               <span class="kw">if</span>(mass.le.zpars(3))<span class="kw">then</span>
                  rx = <a href="function__rgbf.html">rgbf</a>(mt,lums(3))
               <span class="kw">else</span>
<span class="comm">* He-ignition and end of HG occur at Rmin
</span>                  rmin = <a href="function__rminf.html">rminf</a>(mass)
                  ry = <a href="function__ragbf.html">ragbf</a>(mt,lums(4),zpars(2))
                  rx = MIN(rmin,ry)
                  <span class="kw">if</span>(mass.le.mlp)<span class="kw">then</span>
                     texp = log(mass/mlp)/log(zpars(3)/mlp)
                     rx = <a href="function__rgbf.html">rgbf</a>(mt,lums(4))
                     rx = rmin*(rx/rmin)**texp
                  <span class="kw">endif</span>
                  tau2 = <a href="function__tblf.html">tblf</a>(mass,zpars(2),zpars(3))
                  <span class="kw">if</span>(tau2.eq.0.0) rx = ry
               <span class="kw">endif</span>
               r = rtms*(rx/rtms)**tau
               kw = 2
            <span class="kw">endif</span>
<span class="comm">*
</span>         <span class="kw">endif</span>
<span class="comm">*
</span><span class="comm">* Now the GB, CHeB and AGB evolution.
</span><span class="comm">*
</span>      elseif(aj.lt.tscls(2))<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">*        Red Giant.
</span><span class="comm">*
</span>         kw = 3
         lum = <a href="function__lgbtf.html">lgbtf</a>(aj,GB(1),GB,tscls(4),tscls(5),tscls(6))
         <span class="kw">if</span>(mass.le.zpars(2))<span class="kw">then</span>
<span class="comm">* Star has a degenerate He core which grows on the GB
</span>            mc = <a href="function__mcgbf.html">mcgbf</a>(lum,GB,lums(6))
         <span class="kw">else</span>
<span class="comm">* Star has a non-degenarate He core which may grow, but
</span><span class="comm">* only slightly, on the GB
</span>            tau = (aj - tscls(1))/(tscls(2) - tscls(1))
            mcx = <a href="function__mcheif.html">mcheif</a>(mass,zpars(2),zpars(9))
            mcy = <a href="function__mcheif.html">mcheif</a>(mass,zpars(2),zpars(10))
            mc = mcx + (mcy - mcx)*tau
         <span class="kw">endif</span>
         r = <a href="function__rgbf.html">rgbf</a>(mt,lum)
         <span class="kw">if</span>(mc.ge.mt)<span class="kw">then</span>
            aj = 0.d0
            <span class="kw">if</span>(mass.gt.zpars(2))<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Zero-age helium star
</span><span class="comm">*
</span>               mc = mt
               mass = mt
               kw = 7
               <span class="kw">CALL</span> <a href="subroutine__star.html">star</a>(kw,mass,mt,tm,tn,tscls,lums,GB,zpars)
            <span class="kw">else</span>
<span class="comm">*
</span><span class="comm">* Zero-age helium white dwarf.
</span><span class="comm">*
</span>               mc = mt
               kw = 10
            <span class="kw">endif</span>
         <span class="kw">endif</span>
<span class="comm">*
</span>      elseif(aj.lt.tbagb)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">*       Core helium burning star.
</span><span class="comm">*
</span>         <span class="kw">if</span>(kw.eq.3.and.mass.le.zpars(2))<span class="kw">then</span>
            mass = mt
            <span class="kw">CALL</span> <a href="subroutine__star.html">star</a>(kw,mass,mt,tm,tn,tscls,lums,GB,zpars)
            aj = tscls(2)
         <span class="kw">endif</span>
         kw = 4
         <span class="kw">if</span>(mass.le.zpars(2))<span class="kw">then</span>
            mcx = <a href="function__mcgbf.html">mcgbf</a>(lums(4),GB,lums(6))
         <span class="kw">else</span>
            mcx = <a href="function__mcheif.html">mcheif</a>(mass,zpars(2),zpars(10))
         <span class="kw">end</span> <span class="kw">if</span>
         tau = (aj - tscls(2))/tscls(3)
         mc = mcx + (<a href="function__mcagbf.html">mcagbf</a>(mass) - mcx)*tau
         <span class="kw">if</span>(mass.le.zpars(2))<span class="kw">then</span>
            lx = lums(5)
            ly = lums(7)
            rx = <a href="function__rzahbf.html">rzahbf</a>(mt,mc,zpars(2))
            rmin = <a href="function__rgbf.html">rgbf</a>(mt,lx)*zpars(13)**(mass/zpars(2))
            texp = MIN(MAX(0.4d0,rmin/rx),2.5d0)
            ry = <a href="function__ragbf.html">ragbf</a>(mt,ly,zpars(2))
            <span class="kw">if</span>(rmin.lt.rx)<span class="kw">then</span>
               taul = (log(rx/rmin))**(1.d0/3.d0)
            <span class="kw">else</span>
               rmin = rx
               taul = 0.d0
            <span class="kw">endif</span>
            tauh = (log(ry/rmin))**(1.d0/3.d0)
            tau2 = taul*(tau - 1.0d0) + tauh*tau
            r = rmin*exp(abs(tau2)**3)
            lum = lx*(ly/lx)**(tau**texp)
         elseif(mass.gt.zpars(3))<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* For HM stars He-ignition takes place at Rmin in the HG, and CHeB
</span><span class="comm">* consists of a blue phase (before tloop) and a RG phase (after tloop).
</span><span class="comm">*
</span>            tau2 = <a href="function__tblf.html">tblf</a>(mass,zpars(2),zpars(3))
            tloop = tscls(2) + tau2*tscls(3)
            rmin = <a href="function__rminf.html">rminf</a>(mass)
            rx = <a href="function__ragbf.html">ragbf</a>(mt,lums(4),zpars(2))
            rmin = MIN(rmin, rx)
            <span class="kw">if</span>(mass.le.mlp) <span class="kw">then</span>
               texp = log(mass/mlp)/log(zpars(3)/mlp)
               rx = <a href="function__rgbf.html">rgbf</a>(mt,lums(4))
               rx = rmin*(rx/rmin)**texp
            <span class="kw">else</span>
               rx = rmin
            <span class="kw">end</span> <span class="kw">if</span>
            texp = MIN(MAX(0.4d0,rmin/rx),2.5d0)
            lum = lums(4)*(lums(7)/lums(4))**(tau**texp)
            <span class="kw">if</span>(aj.lt.tloop)<span class="kw">then</span>
               ly = lums(4)*(lums(7)/lums(4))**(tau2**texp)
               ry = <a href="function__ragbf.html">ragbf</a>(mt,ly,zpars(2))
               taul = 0.d0
               <span class="kw">if</span>(rmin.ne.rx) taul = (log(rx/rmin))**(1.d0/3.d0)
               tauh = (log(ry/rmin))**(1.d0/3.d0)
               tau = (aj - tscls(2))/(tau2*tscls(3))
               tau2 = taul*(tau - 1.0d0) + tauh*tau
               r = rmin*exp(abs(tau2)**3)
            <span class="kw">else</span>
               r = <a href="function__ragbf.html">ragbf</a>(mt,lum,zpars(2))
            <span class="kw">end</span> <span class="kw">if</span>
         <span class="kw">else</span>
<span class="comm">*
</span><span class="comm">* For IM stars CHeB consists of a RG phase (before tloop) and a blue
</span><span class="comm">* loop (after tloop).
</span><span class="comm">*
</span>            tau2 = 1.d0 - <a href="function__tblf.html">tblf</a>(mass,zpars(2),zpars(3))
            tloop = tscls(2) + tau2*tscls(3)
            <span class="kw">if</span>(aj.lt.tloop)<span class="kw">then</span>
               tau = (tloop - aj)/(tau2*tscls(3))
               lum = lums(5)*(lums(4)/lums(5))**(tau**3)
               r = <a href="function__rgbf.html">rgbf</a>(mt,lum)
            <span class="kw">else</span>
               lx = lums(5)
               ly = lums(7)
               rx = <a href="function__rgbf.html">rgbf</a>(mt,lx)
               rmin = <a href="function__rminf.html">rminf</a>(mt)
               texp = MIN(MAX(0.4d0,rmin/rx),2.5d0)
               ry = <a href="function__ragbf.html">ragbf</a>(mt,ly,zpars(2))
               <span class="kw">if</span>(rmin.lt.rx)<span class="kw">then</span>
                  taul = (log(rx/rmin))**(1.d0/3.d0)
               <span class="kw">else</span>
                  rmin = rx
                  taul = 0.d0
               <span class="kw">endif</span>
               tauh = (log(ry/rmin))**(1.d0/3.d0)
               tau = (aj - tloop)/(tscls(3) - (tloop - tscls(2)))
               tau2 = taul*(tau - 1.d0) + tauh*tau
               r = rmin*exp(abs(tau2)**3)
               lum = lx*(ly/lx)**(tau**texp)
            <span class="kw">endif</span>
         <span class="kw">endif</span>
<span class="comm">* 
</span><span class="comm">* Test whether core mass exceeds total mass.
</span><span class="comm">*
</span>         <span class="kw">if</span>(mc.ge.mt)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Evolved MS naked helium star.
</span><span class="comm">*
</span>            kw = 7
            xx = (aj - tscls(2))/tscls(3)
            mass = mt
            <span class="kw">CALL</span> <a href="subroutine__star.html">star</a>(kw,mass,mt,tm,tn,tscls,lums,GB,zpars)
            aj = xx*tm
         <span class="kw">endif</span>
      <span class="kw">else</span>
<span class="comm">*
</span><span class="comm">*        Asymptotic Red Giant.
</span><span class="comm">*
</span><span class="comm">* Set the core mass and then test whether it exceeds either
</span><span class="comm">* the total mass or the maximum allowed core mass.
</span><span class="comm">*
</span><span class="comm">* On the AGB the He core mass remains constant until at Ltp it
</span><span class="comm">* is caught by the C core mass and they grow together.
</span><span class="comm">*
</span>         mcbagb = <a href="function__mcagbf.html">mcagbf</a>(mass)
         mcx = <a href="function__mcgbtf.html">mcgbtf</a>(tbagb,GB(8),GB,tscls(7),tscls(8),tscls(9))
         mcmax = MAX(MAX(mch,0.773d0*mcbagb-0.35d0),1.05d0*mcx)
         <span class="kw">if</span>(aj.lt.tscls(13))<span class="kw">then</span>
            mcx = <a href="function__mcgbtf.html">mcgbtf</a>(aj,GB(8),GB,tscls(7),tscls(8),tscls(9))
            mc = mcbagb
            lum = <a href="function__lmcgbf.html">lmcgbf</a>(mcx,GB)
            <span class="kw">if</span>(mt.le.mc)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Evolved naked helium star as the envelope is lost but the
</span><span class="comm">* star has not completed its interior burning. The star becomes
</span><span class="comm">* a post-HeMS star.
</span><span class="comm">*
</span>               kw = 9
               mt = mc
               mass = mt
               mc = mcx
               <span class="kw">CALL</span> <a href="subroutine__star.html">star</a>(kw,mass,mt,tm,tn,tscls,lums,GB,zpars)
               <span class="kw">if</span>(mc.le.GB(7))<span class="kw">then</span>
                  aj = tscls(4) - (1.d0/((GB(5)-1.d0)*GB(8)*GB(4)))*
                            (mc**(1.d0-GB(5)))
               <span class="kw">else</span>
                  aj = tscls(5) - (1.d0/((GB(6)-1.d0)*GB(8)*GB(3)))*
                            (mc**(1.d0-GB(6)))
               <span class="kw">endif</span>
               aj = MAX(aj,tm)
               <span class="kw">goto</span> 90
            <span class="kw">else</span>
               kw = 5
            <span class="kw">endif</span>
         <span class="kw">else</span>
            kw = 6
            mc = <a href="function__mcgbtf.html">mcgbtf</a>(aj,GB(2),GB,tscls(10),tscls(11),tscls(12))
            lum = <a href="function__lmcgbf.html">lmcgbf</a>(mc,GB)
<span class="comm">*
</span><span class="comm">* Approximate 3rd Dredge-up on AGB by limiting Mc.
</span><span class="comm">*
</span>            lambda = MIN(0.9d0,0.3d0+0.001d0*mass**5)
            tau = tscls(13)
            mcx = <a href="function__mcgbtf.html">mcgbtf</a>(tau,GB(2),GB,tscls(10),tscls(11),tscls(12))
            mcy = mc
            mc = mc - lambda*(mcy-mcx)
            mcx = mc
            mcmax = MIN(mt,mcmax)   
         <span class="kw">endif</span>
         r = <a href="function__ragbf.html">ragbf</a>(mt,lum,zpars(2))
<span class="comm">*
</span><span class="comm">* Mc,x represents the C core mass
</span><span class="comm">*
</span>         <span class="kw">if</span>(mcx.ge.mcmax)<span class="kw">then</span>
            aj = 0.d0
            mc = mcmax
            <span class="kw">if</span>(mc.lt.mch)<span class="kw">then</span>
               <span class="kw">if</span>(mcbagb.lt.1.6)<span class="kw">then</span>
<span class="comm">*     
</span><span class="comm">* Zero-age Carbon/Oxygen White Dwarf
</span><span class="comm">*
</span>                  mt = mc
                  kw = 11
               <span class="kw">else</span>
<span class="comm">*     
</span><span class="comm">* Zero-age Oxygen/Neon White Dwarf
</span><span class="comm">*
</span>                  mt = mc
                  kw = 12
               <span class="kw">endif</span>
            <span class="kw">else</span>
               <span class="kw">if</span>(mcbagb.lt.1.6)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Star is not massive enough to ignite C burning.
</span><span class="comm">* so no remnant is left after the SN
</span><span class="comm">*
</span>                  mt = 0.d0
                  r = 0.d0
                  kw = 15
               <span class="kw">else</span>
                  mt = 1.17d0 + mc/11.12d0
                  mc = mt
                  <span class="kw">if</span>(mt.le.mxns)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Zero-age Neutron star
</span><span class="comm">*
</span>                     kw = 13
                  <span class="kw">else</span>
<span class="comm">*
</span><span class="comm">* Zero-age Black hole
</span><span class="comm">*
</span>                     kw = 14
                  <span class="kw">endif</span>  
               <span class="kw">endif</span>
            <span class="kw">endif</span>
         <span class="kw">endif</span>
<span class="comm">*
</span>      <span class="kw">endif</span>
<span class="comm">*
</span> 90   <span class="kw">continue</span>
<span class="comm">*
</span>      <span class="kw">if</span>(kw.ge.7.and.kw.le.9)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Naked Helium Star
</span><span class="comm">*
</span>         rx = <a href="function__rzhef.html">rzhef</a>(mt)
         <span class="kw">if</span>(aj.lt.tm)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Main Sequence
</span><span class="comm">*
</span>            kw = 7
            tau = aj/tm
            am = MAX(0.d0,0.85d0-0.08d0*mass)
            lum = lums(1)*(1.d0+0.45d0*tau+am*tau**2)
            am = MAX(0.d0,0.4d0-0.22d0*LOG10(mt))
            r = rx*(1.d0+am*(tau-tau**6))
<span class="comm">* Star has no core mass and hence no memory of its past
</span><span class="comm">* which is why we subject mass and mt to mass loss for
</span><span class="comm">* this phase.
</span>            mc = 0.d0
            <span class="kw">if</span>(mt.lt.zpars(10)) kw = 10
         <span class="kw">else</span>
<span class="comm">*
</span><span class="comm">* Helium Shell Burning
</span><span class="comm">*
</span>            kw = 9
            lum = <a href="function__lgbtf.html">lgbtf</a>(aj,GB(8),GB,tscls(4),tscls(5),tscls(6))
            r = <a href="function__rhelmf.html">rhelmf</a>(kw,mt,lum,rx,lums(2))
            mc = <a href="function__mcgbf.html">mcgbf</a>(lum,GB,lums(6))
            mtc = MIN(mt,1.45d0*mt-0.31d0)
            mcmax = MIN(mtc,MAX(mch,0.773d0*mass-0.35d0))
            <span class="kw">if</span>(mc.ge.mcmax)<span class="kw">then</span>
               aj = 0.d0
               mc = mcmax
               <span class="kw">if</span>(mc.lt.mch)<span class="kw">then</span>
                  <span class="kw">if</span>(mass.lt.1.6)<span class="kw">then</span>
<span class="comm">*     
</span><span class="comm">* Zero-age Carbon/Oxygen White Dwarf
</span><span class="comm">*
</span>                     mt = MAX(mc,(mc+0.31d0)/1.45d0)
                     kw = 11
                  <span class="kw">else</span>
<span class="comm">*     
</span><span class="comm">* Zero-age Oxygen/Neon White Dwarf
</span><span class="comm">*
</span>                     mt = mc
                     kw = 12
                  <span class="kw">endif</span>
               <span class="kw">else</span>
                  <span class="kw">if</span>(mass.lt.1.6)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Star is not massive enough to ignite C burning.
</span><span class="comm">* so no remnant is left after the SN
</span><span class="comm">*
</span>                     mt = 0.d0
                     r = 0.d0
                     kw = 15
                  <span class="kw">else</span>
                     mt = 1.17d0 + mc/11.12d0
                     mc = mt
                     <span class="kw">if</span>(mt.le.mxns)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Zero-age Neutron star
</span><span class="comm">*
</span>                        kw = 13
                     <span class="kw">else</span>
<span class="comm">*
</span><span class="comm">* Zero-age Black hole
</span><span class="comm">*
</span>                        kw = 14
                     <span class="kw">endif</span>
                  <span class="kw">endif</span>  
               <span class="kw">endif</span>
            <span class="kw">endif</span>
         <span class="kw">endif</span>
      <span class="kw">endif</span>
<span class="comm">*
</span>      <span class="kw">if</span>(kw.ge.10.and.kw.le.12)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">*        White dwarf.
</span><span class="comm">*
</span>         mc = mt
         <span class="kw">if</span>(mc.ge.mch)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Accretion induced supernova with no remnant
</span><span class="comm">*
</span>            kw = 15
            aj = 0.d0
            mt = 0.d0
            r = 0.d0
         <span class="kw">else</span>
            <span class="kw">if</span>(kw.eq.10)<span class="kw">then</span>
               xx = zpars(14)/ahe
            <span class="kw">else</span>
               xx = zpars(14)/aco
            <span class="kw">endif</span>
            lum = 635.d0*mt*xx/(aj+0.1d0)**1.4
            r = 0.0115d0*SQRT(MAX(7.5614367d-07,(mch/mt)**(2.d0/3.d0)
                                      - (mt/mch)**(2.d0/3.d0)))
         <span class="kw">endif</span>
      <span class="kw">endif</span>
<span class="comm">*
</span>      <span class="kw">if</span>(kw.eq.13)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">*        Neutron Star.
</span><span class="comm">*
</span>         mc = mt
         <span class="kw">if</span>(mc.gt.mxns)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">* Accretion induced Black Hole?
</span><span class="comm">*
</span>            kw = 14
            aj = 0.d0
         <span class="kw">else</span>
            lum = 40.d0/(MAX(aj,1.d0))**3.d0
            r = 1.0d-05
         <span class="kw">endif</span>
      <span class="kw">endif</span>
<span class="comm">*
</span>      <span class="kw">if</span>(kw.eq.14)<span class="kw">then</span>
<span class="comm">*
</span><span class="comm">*        Black hole
</span><span class="comm">*
</span>         mc = mt
         lum = 1.0d-06/mt
         r = 4.24d-06*mt
      <span class="kw">endif</span>
<span class="comm">*
</span><span class="comm">* Calculate the core radius and the luminosity and radius of the
</span><span class="comm">* remnant that the star will become.
</span><span class="comm">*
</span>      tau = 0.d0
      <span class="kw">if</span>(kw.le.1.or.kw.eq.7)<span class="kw">then</span>
         rc = 0.d0
      elseif(kw.le.3)<span class="kw">then</span>
         <span class="kw">if</span>(mass.gt.zpars(2))<span class="kw">then</span>
            lx = <a href="function__lzhef.html">lzhef</a>(mc)
            rx = <a href="function__rzhef.html">rzhef</a>(mc)
            rc = rx
         <span class="kw">else</span>
            lx = 635.d0*mc*zpars(14)/(ahe*0.1d0**1.4)
            rx = 0.0115d0*SQRT(MAX(7.5614367d-07,
           (mch/mc)**(2.d0/3.d0)-(mc/mch)**(2.d0/3.d0)))
            rc = 5.d0*rx
         <span class="kw">endif</span>
      elseif(kw.eq.4)<span class="kw">then</span>
         tau = (aj - tscls(2))/tscls(3)
         kwp = 7
         <span class="kw">CALL</span> <a href="subroutine__star.html">star</a>(kwp,mc,mc,tm,tn,tscls,lums,GB,zpars)
         am = MAX(0.d0,0.85d0-0.08d0*mc)
         lx = lums(1)*(1.d0+0.45d0*tau+am*tau**2)
         rx = <a href="function__rzhef.html">rzhef</a>(mc)
         am = MAX(0.d0,0.4d0-0.22d0*LOG10(mc))
         rx = rx*(1.d0+am*(tau-tau**6))
         <span class="kw">CALL</span> <a href="subroutine__star.html">star</a>(kw,mass,mt,tm,tn,tscls,lums,GB,zpars)
         rc = rx
      elseif(kw.eq.5)<span class="kw">then</span>
         kwp = 9
         tau = 3.d0*(aj-tbagb)/(tn-tbagb)
         <span class="kw">CALL</span> <a href="subroutine__star.html">star</a>(kwp,mc,mc,tm,tn,tscls,lums,GB,zpars)
         lx = <a href="function__lmcgbf.html">lmcgbf</a>(mcx,GB)
         <span class="kw">if</span>(tau.lt.1.0) lx = lums(2)*(lx/lums(2))**tau
         rx = <a href="function__rzhef.html">rzhef</a>(mc)
         rx = <a href="function__rhelmf.html">rhelmf</a>(kwp,mc,lx,rx,lums(2))
         <span class="kw">CALL</span> <a href="subroutine__star.html">star</a>(kw,mass,mt,tm,tn,tscls,lums,GB,zpars)
         rc = rx
      elseif(kw.le.9)<span class="kw">then</span>
         lx = 635.d0*mc*zpars(14)/(aco*0.1d0**1.4)
         rx = 0.0115d0*SQRT(MAX(7.5614367d-07,
        (mch/mc)**(2.d0/3.d0) - (mc/mch)**(2.d0/3.d0)))
         rc = 5.d0*rx
      <span class="kw">else</span>
         rc = r
      <span class="kw">endif</span>
<span class="comm">*
</span><span class="comm">* Perturb the luminosity and radius due to small envelope mass.
</span><span class="comm">*
</span>      <span class="kw">if</span>(kw.ge.2.and.kw.le.9.and.kw.ne.7)<span class="kw">then</span>
         mew = ((mt-mc)/mt)*MIN(5.d0,MAX(1.2d0,(lum/lum0)**kap))
         <span class="kw">if</span>(kw.ge.8) mew = ((mtc-mc)/mtc)*5.d0
         <span class="kw">if</span>(mew.lt.1.0)<span class="kw">then</span>
            xx = <a href="function__lpertf.html">lpertf</a>(mt,mew)
            lum = lx*(lum/lx)**xx
            <span class="kw">if</span>(r.le.rx)<span class="kw">then</span>
               xx = 0.d0
            <span class="kw">else</span>
               xx = <a href="function__rpertf.html">rpertf</a>(mt,mew,r,rx)
            <span class="kw">endif</span>
            r = rx*(r/rx)**xx
         <span class="kw">endif</span>
         rc = MIN(rc,r)
      <span class="kw">endif</span>
<span class="comm">*
</span>      <span class="kw">return</span>
      <span class="kw">end</span>
</pre>
            
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

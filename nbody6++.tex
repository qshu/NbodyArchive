\magnification=1200
\nopagenumbers
\hsize=6.0truein
\vsize=9.5truein
\font\big=cmr10 scaled \magstep1
\noindent
\centerline { NBODY6++ ROUTINES}
\bigskip
\settabs\+&XXXXXXXXXX&xXXXXXXXXXXXXX&XXXXXXX  \cr
\+&Routine & Called by &Description  \cr
\medskip
\hrule
\medskip
\+&ADJUST.F &MAIN  &Parameter adjustment \& energy check. \cr
\+&BINDAT.F &OUTPUT &Binary data bank on unit 9 (option 8 $>=$ 3). \cr
\+&BINOUT &OUTPUT &Binary analysis \& output (option 8). \cr
\+&BINPOP.F &DATA &Initial binary distribution (option 8). \cr
\+&BLOCK &        &Block data initialization of local labelled COMMON. \cr
\+&BODIES &OUTPUT &Output of single particles \& binaries (options 9 \& 6). \cr
\+&BRAKE  &MDOT  &Magnetic braking and gravitational radiation (\#28). \cr
\+&CHECK  &ADJUST &Error check \& restart (options 2 \& 17). \cr
\+&CHECKL &REGINT &Addition of neighbours during regular step (option 18). \cr
\+&CLINT &INTGRT  &Integration of interstellar cloud (option 13). \cr
\+&CLOUD  &CLOUD0 \& NBINT &Generation of interstellar cloud (option 13). \cr
\+&CLOUD0.F &START &Initialization of cloud parameters (option 13). \cr
\+&CMBODY &KSINT \& TRIPLE &Formation of c.m. body by collision (also by QUAD).
 \cr
\+&CMCORR &ADJUST &Correction of c.m. coordinates \& velocities (option 31). \cr
\+&CMFIRR &NBINT &Irregular force on c.m. particle. \cr
\+&CMFREG &REGINT &Regular \& irregular force on c.m. particle. \cr
\+&CORE   &ADJUST \& OUTPUT &Density centre \& core radius. \cr
\+&CPUTIM.F &ADJUST \& INTGRT &Elapsed CPU time in minutes (initialized in MAIN).
 \cr
\+&DATA.F   &START  &Generation of initial conditions. \cr
\+&DEFINE &INPUT &Definition of input parameters, options \& counters. \cr
\+&DELAY  &IMPACT \& INTGRT &Delay of multiple regularization \& merger (\#15). \cr
\+&EFAC2 &TIDES  &Tidal capture efficiency factor for second harmonic. \cr
\+&EFAC3 &TIDES  &Tidal capture efficiency factor for third harmonic. \cr
\+&EIGENVALUE & ELLAN  & Determine shape of configuration (KZ(39)=2). \cr
\+&ELLAN & ADJUST  & Determine shape of configuration (KZ(39)=2). \cr
\+&ENERGY &ADJUST \& SCALE &Total energy (including binaries \& tidal field). \cr
\+&ENERGY\_MPI &ADJUST \& SCALE &Same as energy, compiled only in parallel code \cr
\+&ESCAPE.F &ADJUST &Removal of escaping particles (option 23). \cr
\+&EVENTS &OUTPUT &Output of stellar evolution events (option 19). \cr
\+&EVOLVE &INTGRT \& KSINT &Diagnostic output of interacting binaries (option 4)
 . \cr
\+&EXPAND &HCORR \& ROCHE &Expansion or contraction of KS orbit (\#19). \cr
\+&FCLOSE &CMBODY \& RESET &Force \& first derivative of close bodies (START3 \&
  4). \cr
\+&FCLOUD &REGINT \& FPOLY1 &Force \& derivative from interstellar clouds (optio
 n 13). \cr
\+&FCORR  &MDOT  &Global corrections due to mass loss from evolving stars. \cr
\+&FICORR &MDOT  &Local corrections due to mass loss. \cr
\+&FILE\_INIT.F & START \& NBODY6 & Opening of all files. \cr
\+&FPCORR &REGINT &Force polynomial derivative corrections. \cr
\+&FPERT &SEARCH \& IMPACT &Perturbing force on dominant components. \cr
\+&FPOLY1 &START \& KSINIT &Total force \& first derivative (also START3 \& 4).
 \cr
\+&FPOLY2 &START \& KSINIT &Second \& third force derivatives (also START3 \& 4)
 . \cr
\+&FPOLY1\_MPI &START \& KSINIT & Same as FPOLY1 used in parallel code.
 \cr
\+&FPOLY2\_MPI &START \& KSINIT & Same as FPOLY2 used in parallel code.
 . \cr

\+&FREEZE &KSINT &Partial reflection of KS orbit (option 25; suppressed). \cr
\+&GNTAGE &CMBODY &Age of giant star. \cr
\+&HCORR  &MDOT  &Mass loss correction of KS orbit (\#19). \cr
\+&HIARCH  &MERGE \& RESET &Diagnostics of hierarchical systems (\#18; also ESCAPE). \cr
\+&HIDAT  &OUTPUT &Hierarchical data bank on unit 87 (\#8 $>$ 3). \cr
\+&HIMAX  &HIDAT  &Maximum eccentricity of hierarchy. \cr
\+&HIMAX2  &IMPACT  &Maximum eccentricity of outer hierarchical binary. \cr
\+&HIPOP.F  &START  &Primordial hierarchical triples (\#18 $>=$ 2). \cr
\+&HISTAB &UNPERT &Hierarchical stability criterion. \cr
\+&HIVEL  &INTGRT \& KICK &High-velocity particles (\#37). \cr
\+&HMDOT  &MDOT  &Mass loss from inner hierarchical binary (\#19). \cr
\+&HMDOT2 &MDOT  &Mass loss from outer hierarchical binary (\#19). \cr
\+&HOTSYS.F  &START  &Hot initial system (option 29; suppressed). \cr
\+&HRDIAG  &INSTAR \& MDOT &H-R diagram for population I stars (options 19 \& 27
 ). \cr
\+&HRPLOT  &OUTPUT &HR diagnostics of evolving stars (\#25). \cr
\+&IBLOCK  &START  &Initialization of hierarchical block-steps. \cr
\+&IMF  &DATA  &Initial mass function (option 20). \cr
\+&IMF2 &DATA  &Special mass functions for binaries and single stars (option 20). \cr
\+&IMPACT &KSINT \& UNPERT &Search for multiple encounters or merger (option 15)
 . \cr
\+&INDEXX & ELLAN  & Determine shape of configuration (KZ(39)=2). \cr
\+&INPUT.F  &START  &Main input. \cr
\+&INSERT &SUBINT &Insert particle index in time-step list. \cr
\+&INSTAR &START &Initialization of stellar evolution parameters (opt. 19). \cr
\+&INTGRT.F &MAIN   &Decision-making \& control of integration paths. \cr
\+&INTIDE.F  &START  &Input \& scaling for tidal capture (option 27). \cr
\+&KEPLER &NBINT &Step reduction of binary c.m. \& close perturber (\#36). \cr
\+&KICK   &KSAPO \& FCORR &Velocity kick for neutron stars (\#19). \cr
\+&KSAPO  &UNPERT &Apocentre/pericentre transformation of KS variables. \cr
\+&KSCORR &KSINT &Corrector for KS regularization. \cr
\+&KSIN2  &MERGE2 \& RESET2 &Initialization of hierarchical KS. \cr
\+&KSINIT &KSREG &Initialization of KS regularization. \cr
\+&KSINT.F  &INTGRT &Regularized two-body integration. \cr
\+&KSLIST &KSINT \& RESET &Selection of KS perturbers (also KSINIT \& KSTIDE). \cr
\+&KSMOD &KSINT &Modified KS motion (option 26). \cr
\+&KSPERI  &KSINT \& KSTIDE &KS variables at pericentre. \cr
\+&KSPERT &KSINT  &Perturbation on KS pair. \cr
\+&KSPOLY &KSINIT \& KSINT &New KS polynomials (also KSMOD \& RESET). \cr
\+&KSPRED &KSINT &Prediction for KS regularization. \cr
\+&KSREG &MAIN \& MERGE  &Preparation of new KS regularization (also RESET). \cr
\+&KSRES  &KSINT \& NBINT &Interpolation \& coordinate transformation of KS pair
 . \cr
\+&KSRES2 &INTGRT &Coordinates \& velocities of KS pair (NBINT in Hermite). \cr
\+&KSTERM &MAIN \& MERGE &Termination of KS regularization (RESET \& IMPACT). \cr
\+&KSTIDE &KSINT  &Tidal interaction of KS pair (option 27). \cr
\+&LAGR.F   &ADJUST \& OUTPUT &Lagrangian radii \& half-mass radius (option 7). \cr
\+&LEVELS &OUTPUT &Diagnostic output of block-steps (option 34). \cr
\+&MATRIX &KSINIT \& KSPOLY &Levi-Civita matrix (also KSCORR, KSRES2 \& RESOLV). \cr
\+&MDOT   &INTGRT &Mass loss from evolving stars (Eggleton code; option 19). \cr
\+&MERGE  &MAIN   &Merging of hierarchical triple or quadrupole. \cr
\+&MLOSS  &INTGRT &Mass loss from evolving stars (option 19 set = 1). \cr
\+&MODIFY.F &MAIN &Modified input parameters at restart. \cr
\+&MYDUMP.F &ADJUST \& INTGRT &COMMON save or restart (also MAIN; options 1 \& 2).
  \cr
\+&NBINT  &INTGRT &Irregular integration. \cr
\+&NBLIST &START &Initialization of neighbour list (also START3 \& 4). \cr
\+&NBODY6  &        &Master control flow. \cr
\+&NBPOT &MERGE \& RESET &Potential energy of subsystem (also TRIPLE \& QUAD). \cr
\+&NBREM &MERGE &Ghost removal from neighbour lists (also START3 \& 4). \cr
\+&NBREST &RESET &Restoring ghosts in neighbour lists (also START3 \& 4). \cr
\+&NBSORT &INTGRT &Neighbour list sorting (block-step version). \cr
\+&NBTIDE &NBINT  &Tidal two-body interaction (option 27 $<$ 0; suppressed). \cr
\+&NLMOD &ESCAPE \& KSINIT &Modification of time-step list (also MERGE \& RESET)
 . \cr
\+&OFFSET &ADJUST &Offset of global times (\#35). \cr
\+&ORBIT  &INTGRT  &Two-body elements for close encounter search. \cr
\+&OUTPUT.F &ADJUST \& INTGRT   &Main output \& optional data save. \cr
\+&PERI &KSINT &Pericentre of two-body motion (also TRIPLE \& QUAD). \cr
\+&PERMIT &IMPACT &Decision-making for unperturbed triple or quad. \cr
\+&PFAC  &HIMAX &Precession factor for hierarchy. \cr
\+&RAN2  &DATA \& BINPOP &Portable random number generator (also CLOUD). \cr
\+&REFLCT &REGINT &Boundary reflection (option 29; suppressed). \cr
\+&REGINT &INTGRT &Regular integration. \cr
\+&REMOVE &KSTERM \& ESCAPE &Removal of particle or KS pair from COMMON tables.
 \cr
\+&RENAME &KSREG &Renaming of COMMON tables for new KS pair. \cr
\+&RESET  &MAIN &Termination of hierarchical merger. \cr
\+&RESET2 &RESET &Termination of double hierarchy. \cr
\+&RESOLV &ENERGY \& XVPRED &Coordinates \& velocities of KS pair (also KSTERM).
  \cr
\+&SCALE.F  &START &Scaling to new units. \cr
\+&SEARCH &NBINT &Close encounter search for KS regularization. \cr
\+&SETUP  &DATA  &Initial coordinates \& velocities (\#5). \cr
\+&SHORT  &INTGRT \& SEARCH &Time-step list for KS candidates. \cr
\+&SHRINK &INTGRT &Shrinking of large time-steps (\#37). \cr
\+&SORT1  &LAGR &Sequential sorting of array (Numerical Recipes). \cr
\+&SORT3  &RESORT &Sorting time-step lists (block-step version). \cr
\+&STAR   &INSTAR \& INTIDE  &Stellar luminosity \& evolution time (also CMBODY)
 . \cr
\+&START.F  &MAIN  &Initial setup \& force polynomials. \cr
\+&STEPI  &NBINT  &Fast time-step expression. \cr
\+&STEPK  &STEPS \& NBINT &Selection of block-steps (also in multiple regulariza
 tions). \cr
\+&STEPS  &FPOLY2 &Initialization of time-steps \& differences. \cr
\+&STUMPF &KSINT \& KSPOLY &Stumpff functions. \cr
\+&SUBINT &INTGRT  &Decision-making for subsystems (block-step version). \cr
\+&TCIRC  &KSINT \& UNPERT &Circularization time. \cr
\+&TIDES  &KSTIDE \& TRIPLE  &Tidal energy loss of interacting stars (also QUAD)
 . \cr
\+&TPERT &KSMOD \& UNPERT &Perturbation time-scale. \cr
\+&TSTEP &NBINT \& STEPS  &Function for standard time-step (block-step version).
  \cr
\+&UNITS  &START  &Initialization of units \& scaling factors. \cr
\+&UNPERT &KSINT &Unperturbed two-body motion (KS regularization). \cr
\+&UPDATE &KSTERM &Modification of COMMON tables after KS termination. \cr
\+&VERIFY &INPUT \& MODIFY  &Validation of main input and restart parameters. \cr
\+&XTRNL0 &START &Initialization of external force (option 14). \cr
\+&XTRNLD &FPOLY1 \& FPOLY2 &External force and higher derivatives for single pa
 rticle. \cr
\+&XTRNLF &NBINT &External force \& first derivative on single particle. \cr
\+&XTRNLP &KSINT \& KSPOLY &External perturbation on KS pair. \cr
\+&XTRNLV &ENERGY \& NBPOT &External potential (also ESCAPE \& BODIES). \cr
\+&XVPRED &ADJUST \& MERGE &Prediction of coordinates \& velocities (also KSINIT
 , etc). \cr
\+&ZARE  &IMPACT &Zare stability parameter for hierarchies. \cr
\+&ZCNSTS &INSTAR \& NBODY6 &Stellar evolution fitting constants. \cr
\+&ZDATA &  &Stellar evolution block data. \cr
\+&ZERO &START &Initialization of global scalars. \cr
\+&ZFUNCS &STAR \& HRDIAG &Stellar evolution fitting functions. \cr
\medskip
\hrule
\bigskip
\bigskip
\centerline {Three-body regularization}
\bigskip
\hrule
\medskip
\+&DERQP3 &DIFSY3 &Derivatives for AZ regularization. \cr
\+&DIFSY3 &TRIPLE &Bulirsch-Stoer integrator for AZ. \cr
\+&EREL3  &DERQP3 \& TRIPLE &Dominant two-body energy in triple system. \cr
\+&EXTEND &SUBSYS \& INTGRT &Size of unperturbed triple or quad. \cr
\+&QPMOD3 &TRIPLE &Modification of AZ variables for tidal dissipation. \cr
\+&STABL3 &QPMOD3 \& TRIPLE &Stability test of triple system. \cr
\+&STABLZ &STABL3 &Zare stability parameter. \cr
\+&START3 &TRIPLE &Initialization \& restart of triple configuration. \cr
\+&SUBSYS &START3 \& START4 &Merging of triple or quad configuration. \cr
\+&TPERI  &DERQP3 \& DERQP4 &Pericentre time for KS motion. \cr
\+&TRANS3 &TRIPLE &Transformation of physical \& KS variables. \cr
\+&TRIPLE &MAIN \& INTGRT &Main routine for triple regularization. \cr
\medskip
\hrule
\bigskip
\bigskip
\centerline {Four-body regularization}
\bigskip
\hrule
\medskip
\+&DERQP4 &DIFSY4 &Derivatives for chain regularization. \cr
\+&DIFSY4 &QUAD   &Bulirsch-Stoer integrator for chain regularization. \cr
\+&ENDREG &QUAD \& RCHAIN &Transformation to physical variables. \cr
\+&EREL4  &DERQP4 \& QUAD &Dominant two-body energy in four-body system. \cr
\+&ICHAIN &STATUS &Determination of regularization chain. \cr
\+&NEWREG &QUAD \& RCHAIN &Initialization of four-body regularization. \cr
\+&NEWSYS &QUAD &Total energy of four-body configuration. \cr
\+&QPMOD4 &QUAD &Modification of chain variables for tidal dissipation. \cr
\+&QUAD   &MAIN \& INTGRT &Main routine for four-body regularization. \cr
\+&RCHAIN &QUAD &Decision-making for chain regularization. \cr
\+&RSORT  &RCHAIN \& STATUS &Sorting of four-body distances. \cr
\+&STABL4 &QPMOD4 &Stability test of four-body system. \cr
\+&START4 &QUAD &Initialization \& restart of four-body configuration. \cr
\+&STATUS &QUAD \& NEWREG &Sorting of square distances \& closest pair indices.
 \cr
\+&TRANS4 &EREL4  &Transformation to physical momenta. \cr
\medskip
\hrule
\bye
